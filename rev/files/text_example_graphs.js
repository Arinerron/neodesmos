
define('text!example_graphs', [], function() {
    return '[{"hash":"2rnqgoa6a4","parent_hash":"89ndqgh5id","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/2rnqgoa6a4.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/2rnqgoa6a4","title":"graphing-calculator-label-example-graph-lines-slope-intercept-form","access":"all","created":"Tue, 18 Aug 2015 19:24:05 GMT","example":true},{"hash":"onfy0dzx2o","parent_hash":"kha6fgxhaf","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/onfy0dzx2o.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/onfy0dzx2o","title":"graphing-calculator-label-example-graph-lines-point-slope-form","access":"all","created":"Tue, 18 Aug 2015 20:21:16 GMT","example":true},{"hash":"md6buy4efz","parent_hash":"fi71u8ej0q","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/md6buy4efz.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/md6buy4efz","title":"graphing-calculator-label-example-graph-lines-two-point-form","access":"all","created":"Tue, 18 Aug 2015 20:21:39 GMT","example":true},{"hash":"zukjgk9iry","parent_hash":"jv9fmw2qz8","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zukjgk9iry.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zukjgk9iry","title":"graphing-calculator-label-example-graph-parabolas-standard-form","access":"all","created":"Tue, 18 Aug 2015 20:22:02 GMT","example":true},{"hash":"8keeh1pt5l","parent_hash":"klodq5d0ph","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8keeh1pt5l.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8keeh1pt5l","title":"graphing-calculator-label-example-graph-parabolas-vertex-form","access":"all","created":"Tue, 18 Aug 2015 20:22:22 GMT","example":true},{"hash":"dxkknajdqb","parent_hash":"t6auzqijzl","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/dxkknajdqb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/dxkknajdqb","title":"graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent","access":"all","created":"Tue, 18 Aug 2015 20:24:05 GMT","example":true},{"hash":"kihjluohq9","parent_hash":"vpnnmvncdb","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/kihjluohq9.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/kihjluohq9","title":"graphing-calculator-label-example-graph-trig-period-and-amplitude","access":"all","created":"Tue, 18 Aug 2015 20:24:32 GMT","example":true},{"hash":"l3u8133jwj","parent_hash":"51d9lso1ia","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/l3u8133jwj.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/l3u8133jwj","title":"graphing-calculator-label-example-graph-trig-phase","access":"all","created":"Tue, 18 Aug 2015 20:24:53 GMT","example":true},{"hash":"7eeumgl7it","parent_hash":"7rnv0erick","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/7eeumgl7it.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/7eeumgl7it","title":"graphing-calculator-label-example-graph-trig-wave-interference","access":"link","created":"Tue, 03 Dec 2019 18:14:54 GMT","example":true},{"hash":"qmzx2skkzy","parent_hash":"s9myfmvujr","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qmzx2skkzy.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qmzx2skkzy","title":"graphing-calculator-label-example-graph-trig-unit-circle","access":"all","created":"Tue, 18 Aug 2015 20:26:18 GMT","example":true},{"hash":"ivud1auwvw","parent_hash":"8dsmqe5ycc","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ivud1auwvw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ivud1auwvw","title":"graphing-calculator-label-example-graph-conic-sections-circle","access":"all","created":"Tue, 18 Aug 2015 20:27:04 GMT","example":true},{"hash":"djcrjdfiif","parent_hash":"0jwlvn9hcs","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/djcrjdfiif.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/djcrjdfiif","title":"graphing-calculator-label-example-graph-conic-sections-parabola-and-focus","access":"all","created":"Tue, 18 Aug 2015 20:27:50 GMT","example":true},{"hash":"afja7ee9mh","parent_hash":"duajwxdopa","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/afja7ee9mh.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/afja7ee9mh","title":"graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci","access":"all","created":"Tue, 18 Aug 2015 20:28:08 GMT","example":true},{"hash":"vgfqbejegx","parent_hash":"k6xcbueze5","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/vgfqbejegx.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/vgfqbejegx","title":"graphing-calculator-label-example-graph-conic-sections-hyperbola","access":"all","created":"Tue, 18 Aug 2015 20:28:27 GMT","example":true},{"hash":"0ovfwwmfrb","parent_hash":"scuci1750d","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/0ovfwwmfrb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/0ovfwwmfrb","title":"graphing-calculator-label-example-graph-polar-rose","access":"all","created":"Tue, 18 Aug 2015 20:28:48 GMT","example":true},{"hash":"qlbdlxyrza","parent_hash":"nicremwert","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qlbdlxyrza.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qlbdlxyrza","title":"graphing-calculator-label-example-graph-polar-logarithmic-spiral","access":"all","created":"Tue, 18 Aug 2015 20:29:08 GMT","example":true},{"hash":"rayzacuktw","parent_hash":"21pbohd07u","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/rayzacuktw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/rayzacuktw","title":"graphing-calculator-label-example-graph-polar-limacon","access":"all","created":"Tue, 18 Aug 2015 20:29:25 GMT","example":true},{"hash":"gxnu7fbgks","parent_hash":"kk3axf8oon","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/gxnu7fbgks.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/gxnu7fbgks","title":"graphing-calculator-label-example-graph-polar-conic-sections","access":"link","created":"Tue, 18 Aug 2015 20:29:42 GMT","example":true},{"hash":"rnyjcjpouf","parent_hash":"ogvj2tzgjj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/rnyjcjpouf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/rnyjcjpouf","title":"graphing-calculator-label-example-graph-parametric-introduction","access":"all","created":"Tue, 18 Aug 2015 20:30:31 GMT","example":true},{"hash":"eg5he4xpg9","parent_hash":"pwjl3pe4da","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/eg5he4xpg9.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/eg5he4xpg9","title":"graphing-calculator-label-example-graph-parametric-cycloid","access":"link","created":"Tue, 18 Aug 2015 20:30:46 GMT","example":true},{"hash":"nyterjs0uf","parent_hash":"nqxx2mhknn","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/nyterjs0uf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/nyterjs0uf","title":"graphing-calculator-label-example-graph-transformations-translating-a-function","access":"link","created":"Fri, 29 Sep 2017 00:47:36 GMT","example":true},{"hash":"vdkjrpznnu","parent_hash":"doxva7ciht","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/vdkjrpznnu.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/vdkjrpznnu","title":"graphing-calculator-label-example-graph-transformations-scaling-a-function","access":"link","created":"Tue, 18 Aug 2015 21:23:20 GMT","example":true},{"hash":"fcjhdt1xdw","parent_hash":"tif5liedlj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/fcjhdt1xdw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/fcjhdt1xdw","title":"graphing-calculator-label-example-graph-transformations-inverse-of-a-function","access":"link","created":"Tue, 18 Aug 2015 21:23:36 GMT","example":true},{"hash":"jwquvmikhr","parent_hash":"2l0r87hkmq","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/jwquvmikhr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/jwquvmikhr","title":"graphing-calculator-label-example-graph-stats-linear-regression","access":"link","created":"Tue, 18 Aug 2015 21:24:01 GMT","example":true},{"hash":"qrdbrcfnsl","parent_hash":"paknt6oneh","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qrdbrcfnsl.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qrdbrcfnsl","title":"graphing-calculator-label-example-graph-stats-anscombes-quartet","access":"link","created":"Mon, 13 Jul 2020 20:40:16 GMT","example":true},{"hash":"sanlujpfmc","parent_hash":"tyszvsmelo","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/sanlujpfmc.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/sanlujpfmc","title":"graphing-calculator-label-example-graph-stats-fourth-order-polynomial","access":"all","created":"Tue, 18 Aug 2015 21:25:02 GMT","example":true},{"hash":"iwfjdrhdyr","parent_hash":"4n11jtzki0","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/iwfjdrhdyr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/iwfjdrhdyr","title":"graphing-calculator-label-example-graph-lists-family-of-sin-curves","access":"link","created":"Tue, 18 Aug 2015 21:25:30 GMT","example":true},{"hash":"ib4qkln029","parent_hash":"1flkupc1yt","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ib4qkln029.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ib4qkln029","title":"graphing-calculator-label-example-graph-lists-curve-stitching","access":"link","created":"Thu, 05 May 2016 06:33:59 GMT","example":true},{"hash":"zdv2kras4n","parent_hash":"fqhp5hq3ka","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zdv2kras4n.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zdv2kras4n","title":"graphing-calculator-label-example-graph-lists-plotting-a-list-of-points","access":"link","created":"Tue, 18 Aug 2015 21:27:01 GMT","example":true},{"hash":"qtzamwcdrk","parent_hash":"aqgbwm3qfd","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qtzamwcdrk.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qtzamwcdrk","title":"graphing-calculator-label-example-graph-calculus-derivatives","access":"link","created":"Tue, 18 Aug 2015 21:27:17 GMT","example":true},{"hash":"mekfho0w38","parent_hash":"irip8pnpdf","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/mekfho0w38.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/mekfho0w38","title":"graphing-calculator-label-example-graph-calculus-secant-line","access":"link","created":"Tue, 18 Aug 2015 21:27:32 GMT","example":true},{"hash":"fs3lx8gptb","parent_hash":"dlzhsldcgo","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/fs3lx8gptb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/fs3lx8gptb","title":"graphing-calculator-label-example-graph-calculus-tangent-line","access":"link","created":"Tue, 18 Aug 2015 21:27:46 GMT","example":true},{"hash":"noanuckuli","parent_hash":"gkjridbqfj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/noanuckuli.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/noanuckuli","title":"graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x","access":"link","created":"Tue, 18 Aug 2015 21:28:02 GMT","example":true},{"hash":"qigfpckugc","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qigfpckugc.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qigfpckugc","title":"graphing-calculator-label-example-graph-calculus-integrals","access":"link","created":"Tue, 19 Apr 2016 14:03:33 GMT","example":true},{"hash":"u2qz73ufju","parent_hash":"o3pwn3vkgh","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/u2qz73ufju.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/u2qz73ufju","title":"graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds","access":"link","created":"Tue, 19 Apr 2016 14:12:40 GMT","example":true},{"hash":"gaa5aqyb5s","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/gaa5aqyb5s.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/gaa5aqyb5s","title":"graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus","access":"link","created":"Tue, 19 Apr 2016 14:15:45 GMT","example":true},{"hash":"8hxtdephtf","parent_hash":"xova2bfhj5","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8hxtdephtf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8hxtdephtf","title":"graphing-calculator-label-example-graph-pac-man","access":"link","created":"Mon, 20 Apr 2015 14:47:01 GMT","example":true,"easterEgg":"betchacant"},{"hash":"qbaliml2om","parent_hash":"8mmk4hrmqg","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qbaliml2om.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qbaliml2om","title":"graphing-calculator-label-example-graph-pride-flag","access":"link","created":"Wed, 02 Jun 2021 01:46:57 GMT","example":true,"easterEgg":"pride"},{"hash":"ieellz6qbr","parent_hash":"velayq9vsr","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ieellz6qbr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ieellz6qbr","title":"graphing-calculator-label-example-graph-pride-flag","access":"link","created":"Wed, 02 Jun 2021 01:51:23 GMT","example":true,"easterEgg":"pride"},{"hash":"dhzndt8brx","parent_hash":"brei8peg52","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/dhzndt8brx.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/dhzndt8brx","title":"graphing-calculator-label-example-graph-3d-world","access":"link","created":"Fri, 03 Jun 2016 01:50:06 GMT","example":true,"easterEgg":"betchacant"},{"hash":"zzhx3zzlns","parent_hash":"ccmfndxptv","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zzhx3zzlns.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zzhx3zzlns","title":"graphing-calculator-label-example-graph-checkerboard-inversion","access":"link","created":"Thu, 02 Jun 2016 22:06:08 GMT","example":true,"easterEgg":"betchacant"},{"hash":"c1u72uowae","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/c1u72uowae.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/c1u72uowae","title":"graphing-calculator-label-example-graph-regular-sine-wave","access":"link","created":"Sun, 18 Aug 2013 06:25:20 GMT","example":true,"easterEgg":"betchacant"},{"hash":"2mwse3jtff","parent_hash":"msmdonti4c","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/2mwse3jtff.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/2mwse3jtff","title":"graphing-calculator-label-example-graph-fastest-path-to-a-point","access":"link","created":"Thu, 02 Jun 2016 22:02:44 GMT","example":true,"easterEgg":"betchacant"},{"hash":"8ytrg3nyln","parent_hash":"d7qrsg2hxg","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8ytrg3nyln.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8ytrg3nyln","title":"graphing-calculator-label-example-graph-fireworks","access":"link","created":"Fri, 03 Jun 2016 01:50:52 GMT","example":true,"easterEgg":"betchacant"},{"hash":"9ed6k6wexp","parent_hash":"9ed6k6wexp","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/9qixqdozzh.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/9ed6k6wexp","title":"graphing-calculator-label-example-graph-fractal-valentine","access":"link","created":"Sat, 14 Feb 2015 18:42:18 GMT","example":true,"easterEgg":"betchacant"},{"hash":"am6ab20tmw","parent_hash":"hvycjwscfq","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/am6ab20tmw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/am6ab20tmw","title":"graphing-calculator-label-example-graph-outstretched-arm","access":"link","created":"Fri, 03 Jun 2016 01:45:50 GMT","example":true,"easterEgg":"betchacant"}]\n';
});

var __extends = this && this.__extends || function() {
    var t = function(e, n) {
        return (t = Object.setPrototypeOf || {
            __proto__: []
        }instanceof Array && function(t, e) {
            t.__proto__ = e
        }
        || function(t, e) {
            for (var n in e)
                Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n])
        }
        )(e, n)
    };
    return function(e, n) {
        if ("function" != typeof n && null !== n)
            throw new TypeError("Class extends value " + String(n) + " is not a constructor or null");
        function r() {
            this.constructor = e
        }
        t(e, n),
        e.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype,
        new r)
    }
}();
!function() {
    var t = -1
      , e = window.jQuery
      , n = Math.min
      , r = Math.max;
    if (!e)
        throw "MathQuill requires jQuery 1.5.2+ to be loaded first";
    function i() {}
    function o(t, e) {
        if (!e)
            throw new Error("prayer failed: " + t)
    }
    function s(e) {
        o("a direction was passed", e === t || 1 === e)
    }
    var a = function() {
        function e(t) {
            this.msg = "",
            this.items = [],
            this.controller = t,
            this.span = document.createElement("span"),
            this.span.className = "dcg-mq-aria-alert",
            this.span.setAttribute("aria-live", "assertive"),
            this.span.setAttribute("aria-atomic", "true")
        }
        return e.prototype.attach = function() {
            var t = this.controller.container && this.controller.container[0];
            t && this.span.parentNode !== t && t.prepend(this.span)
        }
        ,
        e.prototype.queue = function(t, e) {
            void 0 === e && (e = !1);
            var n = "";
            if (t instanceof F) {
                var r = t.mathspeak({
                    ignoreShorthand: !0
                });
                e && (t.parent && t.parent.ariaLabel && "block" === t.ariaLabel ? n = t.parent.ariaLabel + " " + r : t.ariaLabel && (n = t.ariaLabel + " " + r)),
                "" === n && (n = r)
            } else
                n = t || "";
            return this.items.push(n),
            this
        }
        ,
        e.prototype.queueDirOf = function(e) {
            return s(e),
            this.queue(e === t ? "before" : "after")
        }
        ,
        e.prototype.queueDirEndOf = function(e) {
            return s(e),
            this.queue(e === t ? "beginning of" : "end of")
        }
        ,
        e.prototype.alert = function(t) {
            return this.attach(),
            t && this.queue(t),
            this.items.length && (this.msg = this.items.join(" ").replace(/ +(?= )/g, "").trim(),
            this.controller.containerHasFocus() && (this.span.textContent = this.msg)),
            this.clear()
        }
        ,
        e.prototype.clear = function() {
            return this.items.length = 0,
            this
        }
        ,
        e
    }()
      , c = e;
    c.fn.insDirOf = function(e, n) {
        return e === t ? this.insertBefore(n.first()) : this.insertAfter(n.last())
    }
    ,
    c.fn.insAtDirEnd = function(e, n) {
        return e === t ? this.prependTo(n) : this.appendTo(n)
    }
    ;
    var l = function() {
        function e(t, e, n) {
            this.init(t, e, n)
        }
        return e.prototype.init = function(e, n, r) {
            this.parent = e,
            this[t] = n,
            this[1] = r
        }
        ,
        e.copy = function(n) {
            return new e(n.parent,n[t],n[1])
        }
        ,
        e
    }();
    function p(e, n) {
        var r = e[t];
        if (r) {
            var i = e[1];
            if (i)
                for (i = i[1]; r !== i; r = r[1]) {
                    if (!1 === n(r))
                        break
                }
        }
    }
    function u(e, n, r) {
        var i = e[t];
        if (!i)
            return n;
        var o = e[1];
        if (!o)
            return n;
        for (o = o[1]; i !== o; i = i[1])
            n = r(n, i);
        return n
    }
    var h = c()
      , f = function() {
        function e() {
            var i;
            this[n] = 0,
            this[r] = 0,
            this.parent = 0,
            this.ends = ((i = {})[t] = 0,
            i[1] = 0,
            i),
            this.jQ = h,
            this.id = e.uniqueNodeId(),
            e.TempByIdDict[this.id] = this,
            e.scheduleDictionaryCleaning()
        }
        var n, r;
        return e.uniqueNodeId = function() {
            return e.idCounter += 1
        }
        ,
        e.getNodeOfElement = function(t) {
            if (t) {
                if (!t.nodeType)
                    throw new Error("must pass an HTMLElement to NodeBase.getNodeOfElement");
                var e = t;
                return e.mqBlockNode || e.mqCmdNode
            }
        }
        ,
        e.linkElementByBlockId = function(t, n) {
            e.linkElementByBlockNode(t, e.TempByIdDict[n])
        }
        ,
        e.linkElementByBlockNode = function(t, e) {
            t.mqBlockNode = e
        }
        ,
        e.linkElementByCmdNode = function(t, e) {
            t.mqCmdNode = e
        }
        ,
        e.scheduleDictionaryCleaning = function() {
            e.cleaningScheduled || (e.cleaningScheduled = !0,
            setTimeout(e.cleanDictionary))
        }
        ,
        e.cleanDictionary = function() {
            e.cleaningScheduled = !1,
            e.TempByIdDict = {}
        }
        ,
        e.prototype.setEnds = function(e) {
            this.ends = e,
            o("No half-empty node ends", !!this.ends[t] == !!this.ends[1])
        }
        ,
        e.prototype.getEnd = function(t) {
            return this.ends[t]
        }
        ,
        e.prototype.toString = function() {
            return "{{ MathQuill Node #" + this.id + " }}"
        }
        ,
        e.prototype.jQadd = function(t) {
            return this.jQ = this.jQ.add(t)
        }
        ,
        e.prototype.jQize = function(t) {
            var n = c(t || this.html());
            function r(t) {
                if ("getAttribute"in t) {
                    var n = t.getAttribute("mathquill-command-id");
                    if (n) {
                        t.removeAttribute("mathquill-command-id");
                        var i = e.TempByIdDict[n];
                        i.jQadd(t),
                        e.linkElementByCmdNode(t, i)
                    }
                    var o = t.getAttribute("mathquill-block-id");
                    if (o) {
                        t.removeAttribute("mathquill-block-id");
                        var s = e.TempByIdDict[o];
                        s.jQadd(t),
                        e.linkElementByBlockNode(t, s)
                    }
                }
                for (var a = t.firstChild; a; a = a.nextSibling)
                    r(a)
            }
            for (var i = 0; i < n.length; i += 1)
                r(n[i]);
            return n
        }
        ,
        e.prototype.createDir = function(e, n) {
            s(e);
            var r = this;
            return r.jQize(),
            r.jQ.insDirOf(e, n.jQ),
            n[e] = r.adopt(n.parent, n[t], n[1]),
            r
        }
        ,
        e.prototype.createLeftOf = function(e) {
            this.createDir(t, e)
        }
        ,
        e.prototype.selectChildren = function(t, e) {
            return new q(t,e)
        }
        ,
        e.prototype.bubble = function(t) {
            for (var e = this.getSelfNode(); e; e = e.parent) {
                if (!1 === t(e))
                    break
            }
            return this
        }
        ,
        e.prototype.postOrder = function(t) {
            var e = this.getSelfNode();
            return function e(n) {
                return !!n && (n.eachChild(e),
                t(n),
                !0)
            }(e),
            e
        }
        ,
        e.prototype.isEmpty = function() {
            return 0 === this.ends[t] && 0 === this.ends[1]
        }
        ,
        e.prototype.isQuietEmptyDelimiter = function(t) {
            if (!this.isEmpty())
                return !1;
            if (!t)
                return !1;
            if (!this.parent || void 0 === this.parent.ctrlSeq)
                return !1;
            var e = this.parent.ctrlSeq.replace(/^\\(left|right)?/, "");
            return t.hasOwnProperty(e)
        }
        ,
        e.prototype.isStyleBlock = function() {
            return !1
        }
        ,
        e.prototype.isTextBlock = function() {
            return !1
        }
        ,
        e.prototype.children = function() {
            return new m(this.getEnd(t),this.getEnd(1))
        }
        ,
        e.prototype.eachChild = function(t) {
            return p(this.ends, t),
            this
        }
        ,
        e.prototype.foldChildren = function(t, e) {
            return u(this.ends, t, e)
        }
        ,
        e.prototype.withDirAdopt = function(t, e, n, r) {
            var i = this.getSelfNode();
            return new m(i,i).withDirAdopt(t, e, n, r),
            this
        }
        ,
        e.prototype.adopt = function(t, e, n) {
            var r = this.getSelfNode();
            return new m(r,r).adopt(t, e, n),
            this.getSelfNode()
        }
        ,
        e.prototype.disown = function() {
            var t = this.getSelfNode();
            return new m(t,t).disown(),
            this
        }
        ,
        e.prototype.remove = function() {
            return this.jQ.remove(),
            this.disown()
        }
        ,
        e.prototype.shouldIgnoreSubstitutionInSimpleSubscript = function(t) {
            return !!t.disableAutoSubstitutionInSubscripts && (!!this.parent && (this.parent.parent instanceof Dt && !!this.parent.jQ.hasClass("dcg-mq-sub")))
        }
        ,
        e.prototype.getSelfNode = function() {
            return this
        }
        ,
        e.prototype.parser = function() {
            o("Abstract parser() method is never called", !1)
        }
        ,
        e.prototype.html = function() {
            return ""
        }
        ,
        e.prototype.text = function() {
            return ""
        }
        ,
        e.prototype.latex = function() {
            return ""
        }
        ,
        e.prototype.finalizeTree = function(t, e) {}
        ,
        e.prototype.contactWeld = function(t, e) {}
        ,
        e.prototype.blur = function(t) {}
        ,
        e.prototype.focus = function() {}
        ,
        e.prototype.intentionalBlur = function() {}
        ,
        e.prototype.reflow = function() {}
        ,
        e.prototype.registerInnerField = function(t, e) {}
        ,
        e.prototype.chToCmd = function(t, e) {
            o("Abstract chToCmd() method is never called", !1)
        }
        ,
        e.prototype.mathspeak = function(t) {
            return ""
        }
        ,
        e.prototype.seek = function(t, e) {}
        ,
        e.prototype.siblingDeleted = function(t, e) {}
        ,
        e.prototype.siblingCreated = function(t, e) {}
        ,
        e.prototype.finalizeInsert = function(t, e) {}
        ,
        e.prototype.fixDigitGrouping = function(t) {}
        ,
        e.prototype.writeLatex = function(t, e) {}
        ,
        e.prototype.write = function(t, e) {}
        ,
        n = t,
        r = 1,
        e.idCounter = 0,
        e.TempByIdDict = {},
        e.cleaningScheduled = !1,
        e
    }();
    function d(e, n, r) {
        o("a parent is always present", e),
        o("leftward is properly set up", n ? n[1] === r && n.parent === e : e.getEnd(t) === r),
        o("rightward is properly set up", r ? r[t] === n && r.parent === e : e.getEnd(1) === n)
    }
    var m = function() {
        function e(e, n, r) {
            var i, a;
            if (this.jQ = h,
            this.disowned = !1,
            void 0 === r && (r = t),
            s(r),
            o("no half-empty fragments", !e == !n),
            e && n) {
                o("withDir is passed to Fragment", e instanceof F),
                o("oppDir is passed to Fragment", n instanceof F),
                o("withDir and oppDir have the same parent", e.parent === n.parent),
                this.setEnds(((a = {})[r] = e,
                a[-r] = n,
                a));
                var c = this.fold([], function(t, e) {
                    return t.push.apply(t, e.jQ.get()),
                    t
                });
                this.jQ = this.jQ.add(c)
            } else
                this.setEnds(((i = {})[t] = 0,
                i[1] = 0,
                i))
        }
        return e.prototype.setEnds = function(t) {
            this.ends = t
        }
        ,
        e.prototype.getEnd = function(t) {
            return this.ends ? this.ends[t] : 0
        }
        ,
        e.prototype.withDirAdopt = function(e, n, r, i) {
            return e === t ? this.adopt(n, r, i) : this.adopt(n, i, r)
        }
        ,
        e.prototype.adopt = function(e, n, r) {
            var i;
            d(e, n, r);
            var o = this;
            this.disowned = !1;
            var s = o.ends[t];
            if (!s)
                return this;
            var a = o.ends[1];
            if (!a)
                return this;
            var c = ((i = {})[t] = e.getEnd(t),
            i[1] = e.getEnd(1),
            i);
            return n || (c[t] = s),
            r ? r[t] = a : c[1] = a,
            e.setEnds(c),
            a[1] = r,
            o.each(function(r) {
                return r[t] = n,
                r.parent = e,
                n && (n[1] = r),
                n = r,
                !0
            }),
            o
        }
        ,
        e.prototype.disown = function() {
            var e, n = this, r = n.ends[t];
            if (!r || n.disowned)
                return n;
            this.disowned = !0;
            var i = n.ends[1];
            if (!i)
                return n;
            var o = r.parent;
            d(o, r[t], r),
            d(o, i, i[1]);
            var s = ((e = {})[t] = o.getEnd(t),
            e[1] = o.getEnd(1),
            e);
            r[t] ? r[t][1] = i[1] : s[t] = i[1];
            i[1] ? i[1][t] = r[t] : s[1] = r[t];
            return s[t] && s[1] ? o.setEnds(s) : o.ends = s,
            n
        }
        ,
        e.prototype.remove = function() {
            return this.jQ.remove(),
            this.disown()
        }
        ,
        e.prototype.each = function(t) {
            return p(this.ends, t),
            this
        }
        ,
        e.prototype.fold = function(t, e) {
            return u(this.ends, t, e)
        }
        ,
        e
    }()
      , g = {}
      , v = {};
    function y(t) {
        return t && t.prototype instanceof F
    }
    var b = function(e) {
        function n(t, n, r) {
            var i = e.call(this, t, n, r) || this;
            return i.ancestors = {},
            i
        }
        return __extends(n, e),
        n.fromCursor = function(e) {
            return new n(e.parent,e[t],e[1])
        }
        ,
        n
    }(l)
      , w = function(e) {
        function n(t, n, r) {
            var i = e.call(this, t, 0, 0) || this;
            i.upDownCache = {},
            i.controller = r,
            i.options = n;
            var o = i.jQ = i._jQ = c('<span class="dcg-mq-cursor" aria-hidden="true">&#8203;</span>');
            return i.blink = function() {
                o.toggleClass("dcg-mq-blink")
            }
            ,
            i
        }
        return __extends(n, e),
        n.prototype.show = function() {
            if (this.jQ = this._jQ.removeClass("dcg-mq-blink"),
            this.intervalId)
                clearInterval(this.intervalId);
            else {
                if (this[1]) {
                    var e = this.selection;
                    e && e.getEnd(t)[t] === this[t] ? this.jQ.insertBefore(e.jQ) : this.jQ.insertBefore(this[1].jQ.first())
                } else
                    this.jQ.appendTo(this.parent.jQ);
                this.parent.focus()
            }
            return this.intervalId = setInterval(this.blink, 500),
            this
        }
        ,
        n.prototype.hide = function() {
            return this.intervalId && clearInterval(this.intervalId),
            this.intervalId = 0,
            this.jQ.detach(),
            this.jQ = c(),
            this
        }
        ,
        n.prototype.withDirInsertAt = function(t, e, n, r) {
            var i = this.parent;
            this.parent = e,
            this[t] = n,
            this[-t] = r,
            i !== e && i.blur && i.blur(this)
        }
        ,
        n.prototype.insDirOf = function(t, e) {
            return s(t),
            this.jQ.insDirOf(t, e.jQ),
            this.withDirInsertAt(t, e.parent, e[t], e),
            this.parent.jQ.addClass("dcg-mq-hasCursor"),
            this
        }
        ,
        n.prototype.insLeftOf = function(e) {
            return this.insDirOf(t, e)
        }
        ,
        n.prototype.insRightOf = function(t) {
            return this.insDirOf(1, t)
        }
        ,
        n.prototype.insAtDirEnd = function(t, e) {
            return s(t),
            this.jQ.insAtDirEnd(t, e.jQ),
            this.withDirInsertAt(t, e, 0, e.getEnd(t)),
            e.focus(),
            this
        }
        ,
        n.prototype.insAtLeftEnd = function(e) {
            return this.insAtDirEnd(t, e)
        }
        ,
        n.prototype.insAtRightEnd = function(t) {
            return this.insAtDirEnd(1, t)
        }
        ,
        n.prototype.jumpUpDown = function(t, e) {
            var n = this;
            n.upDownCache[t.id] = l.copy(n);
            var r = n.upDownCache[e.id];
            if (r) {
                var i = r[1];
                i ? n.insLeftOf(i) : n.insAtRightEnd(r.parent)
            } else {
                var o = n.offset().left;
                e.seek(o, n)
            }
            n.controller.aria.queue(e, !0)
        }
        ,
        n.prototype.offset = function() {
            var t = this.jQ.removeClass("dcg-mq-cursor").offset();
            return this.jQ.addClass("dcg-mq-cursor"),
            t
        }
        ,
        n.prototype.unwrapGramp = function() {
            var e = this.parent.parent
              , n = e.parent
              , r = e[1]
              , i = e[t];
            if (e.disown().eachChild(function(t) {
                return t.isEmpty() || (t.children().adopt(n, i, r).each(function(t) {
                    return t.jQ.insertBefore(e.jQ.first()),
                    !0
                }),
                i = t.getEnd(1)),
                !0
            }),
            !this[1]) {
                var o = this[t];
                if (o)
                    this[1] = o[1];
                else
                    for (; !this[1]; ) {
                        var s = this.parent[1];
                        if (!s) {
                            this[1] = e[1],
                            this.parent = n;
                            break
                        }
                        this.parent = s,
                        this[1] = s.getEnd(t)
                    }
            }
            var a = this[1];
            a ? this.insLeftOf(a) : this.insAtRightEnd(n),
            e.jQ.remove();
            var c = e[t]
              , l = e[1];
            c && c.siblingDeleted(this.options, 1),
            l && l.siblingDeleted(this.options, t)
        }
        ,
        n.prototype.startSelection = function() {
            for (var t = this.anticursor = b.fromCursor(this), e = t.ancestors, n = t; n.parent; n = n.parent)
                e[n.parent.id] = n
        }
        ,
        n.prototype.endSelection = function() {
            delete this.anticursor
        }
        ,
        n.prototype.select = function() {
            var e, n = this.anticursor;
            if (this[t] === n[t] && this.parent === n.parent)
                return !1;
            for (var r = this; r.parent; r = r.parent)
                if (r.parent.id in n.ancestors) {
                    e = r.parent;
                    break
                }
            o("cursor and anticursor in the same tree", e);
            var i, s, a = e, c = n.ancestors[a.id], p = 1;
            if (r[t] !== c)
                for (var u = r; u; u = u[1])
                    if (u[1] === c[1]) {
                        p = t,
                        i = r,
                        s = c;
                        break
                    }
            1 === p && (i = c,
            s = r),
            i instanceof l && (i = i[1]),
            s instanceof l && (s = s[t]),
            this.hide().selection = a.selectChildren(i, s);
            var h = this.selection.getEnd(p);
            return this.insDirOf(p, h),
            this.selectionChanged(),
            !0
        }
        ,
        n.prototype.resetToEnd = function(e) {
            this.clearSelection();
            var n = e.root;
            this[1] = 0,
            this[t] = n.getEnd(1),
            this.parent = n
        }
        ,
        n.prototype.clearSelection = function() {
            return this.selection && (this.selection.clear(),
            delete this.selection,
            this.selectionChanged()),
            this
        }
        ,
        n.prototype.deleteSelection = function() {
            var e = this.selection;
            e && (this[t] = e.getEnd(t)[t],
            this[1] = e.getEnd(1)[1],
            e.remove(),
            this.selectionChanged(),
            delete this.selection)
        }
        ,
        n.prototype.replaceSelection = function() {
            var e = this.selection;
            return e && (this[t] = e.getEnd(t)[t],
            this[1] = e.getEnd(1)[1],
            delete this.selection),
            e
        }
        ,
        n.prototype.depth = function() {
            for (var t = this, e = 0; t = t.parent; )
                e += t instanceof nt ? 1 : 0;
            return e
        }
        ,
        n.prototype.isTooDeep = function(t) {
            return void 0 !== this.options.maxDepth && this.depth() + (t || 0) > this.options.maxDepth
        }
        ,
        n.prototype.selectionChanged = function() {}
        ,
        n
    }(l)
      , q = function(e) {
        function n(t, n, r) {
            var i = e.call(this, t, n, r) || this;
            return i.jQ = i.jQ.wrapAll('<span class="dcg-mq-selection"></span>').parent(),
            i
        }
        return __extends(n, e),
        n.prototype.setEnds = function(e) {
            o("Selection ends are never empty", e[t] && e[1]),
            this.ends = e
        }
        ,
        n.prototype.getEnd = function(t) {
            return this.ends[t]
        }
        ,
        n.prototype.adopt = function(t, n, r) {
            return this.jQ.replaceWith(this.jQ = this.jQ.children()),
            e.prototype.adopt.call(this, t, n, r)
        }
        ,
        n.prototype.clear = function() {
            return this.jQ.replaceWith(this.jQ[0].childNodes),
            this
        }
        ,
        n.prototype.join = function(t, e) {
            return void 0 === e && (e = ""),
            this.fold("", function(n, r) {
                return n + e + r[t]()
            })
        }
        ,
        n
    }(m)
      , x = function() {
        function e(t, e, n) {
            this.id = t.id,
            this.data = {},
            this.root = t,
            this.container = e,
            this.options = n,
            this.aria = new a(this.getControllerSelf()),
            this.ariaLabel = "Math Input",
            this.ariaPostLabel = "",
            t.controller = this.getControllerSelf(),
            this.cursor = t.cursor = new w(t,n,this.getControllerSelf())
        }
        return e.prototype.getControllerSelf = function() {
            return this
        }
        ,
        e.prototype.handle = function(e, n) {
            var r = this.options.handlers;
            if (r && r.fns[e]) {
                var i = new r.APIClasses[this.KIND_OF_MQ](this);
                n === t || 1 === n ? r.fns[e](n, i) : r.fns[e](i)
            }
        }
        ,
        e.onNotify = function(t) {
            e.notifyees.push(t)
        }
        ,
        e.prototype.notify = function(t) {
            for (var n = 0; n < e.notifyees.length; n += 1)
                e.notifyees[n](this.cursor, t);
            return this
        }
        ,
        e.prototype.setAriaLabel = function(t) {
            var e = this.getAriaLabel();
            return t && "string" == typeof t && "" !== t ? this.ariaLabel = t : this.editable ? this.ariaLabel = "Math Input" : this.ariaLabel = "",
            this.ariaLabel === e || this.containerHasFocus() || this.updateMathspeak(),
            this
        }
        ,
        e.prototype.getAriaLabel = function() {
            return "Math Input" !== this.ariaLabel ? this.ariaLabel : this.editable ? "Math Input" : ""
        }
        ,
        e.prototype.setAriaPostLabel = function(t, e) {
            var n = this;
            return t && "string" == typeof t && "" !== t ? (t !== this.ariaPostLabel && "number" == typeof e && (this._ariaAlertTimeout && clearTimeout(this._ariaAlertTimeout),
            this._ariaAlertTimeout = setTimeout(function() {
                n.containerHasFocus() ? n.aria.alert(n.root.mathspeak().trim() + " " + t.trim()) : n.updateMathspeak()
            }, e)),
            this.ariaPostLabel = t) : (this._ariaAlertTimeout && clearTimeout(this._ariaAlertTimeout),
            this.ariaPostLabel = ""),
            this
        }
        ,
        e.prototype.getAriaPostLabel = function() {
            return this.ariaPostLabel || ""
        }
        ,
        e.prototype.containerHasFocus = function() {
            return document.activeElement && this.container && this.container[0] && this.container[0].contains(document.activeElement)
        }
        ,
        e.prototype.getTextareaOrThrow = function() {
            var t = this.textarea;
            if (!t)
                throw new Error("expected a textarea");
            return t
        }
        ,
        e.prototype.getTextareaSpanOrThrow = function() {
            var t = this.textareaSpan;
            if (!t)
                throw new Error("expected a textareaSpan");
            return t
        }
        ,
        e.prototype.exportMathSpeak = function() {
            return this.root.mathspeak()
        }
        ,
        e.prototype.updateMathspeak = function() {}
        ,
        e.prototype.scrollHoriz = function() {}
        ,
        e.prototype.selectionChanged = function() {}
        ,
        e.prototype.setOverflowClasses = function() {}
        ,
        e.notifyees = [],
        e
    }()
      , k = {}
      , _ = {}
      , E = new function() {}
      , S = function() {}
      , O = function() {}
      , L = function() {
        window.console && console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')
    };
    function T(t) {
        return L(),
        Xt(t)
    }
    T.prototype = O.prototype,
    T.VERSION = "v0.10.1",
    T.interfaceVersion = function(t) {
        if (1 !== t)
            throw "Only interface version 1 supported. You specified: " + t;
        return (L = function() {
            window.console && console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014–2015) → v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide')
        }
        )(),
        T
    }
    ,
    T.getInterface = A;
    var C = A.MIN = 1
      , D = A.MAX = 2;
    function A(n) {
        if (!(C <= n && n <= D))
            throw "Only interface versions between " + C + " and " + D + " supported. You specified: " + n;
        var r = function(t) {
            if (!t || !t.nodeType)
                return null;
            var e = f.getNodeOfElement(c(t).children(".dcg-mq-root-block")[0])
              , n = e && e.controller;
            return n ? new l[n.KIND_OF_MQ](n) : null
        };
        function o(t, e) {
            for (var n in e && e.handlers && (e.handlers = {
                fns: e.handlers,
                APIClasses: l
            }),
            e)
                if (e.hasOwnProperty(n)) {
                    var r = e[n]
                      , i = E[n];
                    t[n] = i ? i(r) : r
                }
        }
        r.L = t,
        r.R = 1,
        r.saneKeyboardEvents = M,
        r.config = function(t) {
            return o(S.prototype, t),
            this
        }
        ,
        r.registerEmbed = function(t, e) {
            if (!/^[a-z][a-z0-9]*$/i.test(t))
                throw "Embed name must start with letter and be only letters and digits";
            _[t] = e
        }
        ;
        var s = function(t) {
            function e(e) {
                var n = t.call(this) || this;
                return n.__controller = e,
                n.__options = e.options,
                n.id = e.id,
                n.data = e.data,
                n
            }
            return __extends(e, t),
            e.prototype.__mathquillify = function(t) {
                var e = this.__controller
                  , n = e.root
                  , r = e.container;
                e.createTextarea();
                var i = r.addClass(t).contents().detach();
                n.jQ = c('<span class="dcg-mq-root-block"/>').appendTo(r),
                f.linkElementByBlockId(n.jQ[0], n.id),
                this.latex(i.text()),
                this.revert = function() {
                    return r.empty().unbind(".mathquill").removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").append(i)
                }
            }
            ,
            e.prototype.config = function(t) {
                return o(this.__options, t),
                this
            }
            ,
            e.prototype.el = function() {
                return this.__controller.container[0]
            }
            ,
            e.prototype.text = function() {
                return this.__controller.exportText()
            }
            ,
            e.prototype.mathspeak = function() {
                return this.__controller.exportMathSpeak()
            }
            ,
            e.prototype.latex = function(t) {
                if (arguments.length > 0) {
                    this.__controller.renderLatexMath(t);
                    var e = this.__controller.cursor;
                    return this.__controller.blurred && e.hide().parent.blur(e),
                    this
                }
                return this.__controller.exportLatex()
            }
            ,
            e.prototype.html = function() {
                return this.__controller.root.jQ.html().replace(/ mathquill-(?:command|block)-id="?\d+"?/g, "").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i, "").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/, "").replace(/ class=(""|(?= |>))/g, "")
            }
            ,
            e.prototype.reflow = function() {
                return this.__controller.root.postOrder(function(t) {
                    t.reflow()
                }),
                this
            }
            ,
            e
        }(O);
        r.prototype = s.prototype;
        var a = function(n) {
            function r() {
                return null !== n && n.apply(this, arguments) || this
            }
            return __extends(r, n),
            r.prototype.__mathquillify = function(t) {
                return n.prototype.__mathquillify.call(this, t),
                this.__controller.editable = !0,
                this.__controller.delegateMouseEvents(),
                this.__controller.editablesTextareaEvents(),
                this
            }
            ,
            r.prototype.focus = function() {
                return this.__controller.getTextareaOrThrow()[0].focus(),
                this.__controller.scrollHoriz(),
                this
            }
            ,
            r.prototype.blur = function() {
                return this.__controller.getTextareaOrThrow().blur(),
                this
            }
            ,
            r.prototype.write = function(t) {
                this.__controller.writeLatex(t),
                this.__controller.scrollHoriz();
                var e = this.__controller.cursor;
                return this.__controller.blurred && e.hide().parent.blur(e),
                this
            }
            ,
            r.prototype.empty = function() {
                var e, n = this.__controller.root, r = this.__controller.cursor;
                return n.setEnds(((e = {})[t] = 0,
                e[1] = 0,
                e)),
                n.jQ.empty(),
                delete r.selection,
                r.insAtRightEnd(n),
                this
            }
            ,
            r.prototype.cmd = function(t) {
                var e = this.__controller.notify(void 0)
                  , n = e.cursor;
                if (/^\\[a-z]+$/i.test(t) && !n.isTooDeep()) {
                    t = t.slice(1);
                    var r, i = g[t];
                    i && (r = i.constructor ? new i(t) : i(t),
                    n.selection && r.replaces(n.replaceSelection()),
                    r.createLeftOf(n.show()))
                } else
                    n.parent.write(n, t);
                return e.scrollHoriz(),
                e.blurred && n.hide().parent.blur(n),
                this
            }
            ,
            r.prototype.select = function() {
                return this.__controller.selectAll(),
                this
            }
            ,
            r.prototype.clearSelection = function() {
                return this.__controller.cursor.clearSelection(),
                this
            }
            ,
            r.prototype.moveToDirEnd = function(t) {
                return this.__controller.notify("move").cursor.insAtDirEnd(t, this.__controller.root),
                this
            }
            ,
            r.prototype.moveToLeftEnd = function() {
                return this.moveToDirEnd(t)
            }
            ,
            r.prototype.moveToRightEnd = function() {
                return this.moveToDirEnd(1)
            }
            ,
            r.prototype.keystroke = function(t, e) {
                for (var n = t.replace(/^\s+|\s+$/g, "").split(/\s+/), r = 0; r < n.length; r += 1)
                    this.__controller.keystroke(n[r], e || {
                        preventDefault: i
                    });
                return this
            }
            ,
            r.prototype.typedText = function(t) {
                for (var e = 0; e < t.length; e += 1)
                    this.__controller.typedText(t.charAt(e));
                return this
            }
            ,
            r.prototype.dropEmbedded = function(t, e, n) {
                var r = t - c(window).scrollLeft()
                  , i = e - c(window).scrollTop()
                  , o = document.elementFromPoint(r, i);
                this.__controller.seek(c(o), t, e),
                (new Zt).setOptions(n).createLeftOf(this.__controller.cursor)
            }
            ,
            r.prototype.setAriaLabel = function(t) {
                return this.__controller.setAriaLabel(t),
                this
            }
            ,
            r.prototype.getAriaLabel = function() {
                return this.__controller.getAriaLabel()
            }
            ,
            r.prototype.setAriaPostLabel = function(t, e) {
                return this.__controller.setAriaPostLabel(t, e),
                this
            }
            ,
            r.prototype.getAriaPostLabel = function() {
                return this.__controller.getAriaPostLabel()
            }
            ,
            r.prototype.clickAt = function(t, n, r) {
                r = r || document.elementFromPoint(t, n);
                var i = this.__controller
                  , o = i.root;
                return e.contains(o.jQ[0], r) || (r = o.jQ[0]),
                i.seek(c(r), t + pageXOffset, n + pageYOffset),
                i.blurred && this.focus(),
                this
            }
            ,
            r.prototype.ignoreNextMousedown = function(t) {
                return this.__controller.cursor.options.ignoreNextMousedown = t,
                this
            }
            ,
            r
        }(s);
        (r.EditableField = function() {
            throw "wtf don't call me, I'm 'abstract'"
        }
        ).prototype = a.prototype;
        var l = {
            AbstractMathQuill: s,
            EditableField: a
        };
        for (var p in k)
            !function(t, e) {
                var i = l[t] = e(l);
                (r[t] = function(e, o) {
                    var s = r(e);
                    if (s instanceof i || !e || !e.nodeType)
                        return s;
                    var a = new V(new i.RootBlock,c(e),new S);
                    return a.KIND_OF_MQ = t,
                    new i(a).__mathquillify(o, n)
                }
                ).prototype = i.prototype
            }(p, k[p]);
        return r
    }
    T.noConflict = function() {
        return window.MathQuill = j,
        T
    }
    ;
    var j = window.MathQuill;
    function Q(t) {
        t.moveOutOf = function(t) {
            this.controller.handle("moveOutOf", t)
        }
        ,
        t.deleteOutOf = function(t) {
            this.controller.handle("deleteOutOf", t)
        }
        ,
        t.selectOutOf = function(t) {
            this.controller.handle("selectOutOf", t)
        }
        ,
        t.upOutOf = function(t) {
            this.controller.handle("upOutOf", t)
        }
        ,
        t.downOutOf = function(t) {
            this.controller.handle("downOutOf", t)
        }
        ,
        t.reflow = function() {
            this.controller.handle("reflow"),
            this.controller.handle("edited"),
            this.controller.handle("edit")
        }
    }
    function I(t, e) {
        throw "Parse Error: " + e + " at " + (t = t ? "'" + t + "'" : "EOF")
    }
    window.MathQuill = T;
    var B = function() {
        function t(t) {
            this._ = t
        }
        return t.prototype.parse = function(e) {
            return this.skip(t.eof)._("" + e, function(t, e) {
                return e
            }, I)
        }
        ,
        t.prototype.or = function(e) {
            o("or is passed a parser", e instanceof t);
            var n = this;
            return new t(function(t, r, i) {
                return n._(t, r, function(n) {
                    return e._(t, r, i)
                })
            }
            )
        }
        ,
        t.prototype.then = function(e) {
            var n = this;
            return new t(function(r, i, s) {
                return n._(r, function(n, r) {
                    var a = e instanceof t ? e : e(r);
                    return o("a parser is returned", a instanceof t),
                    a._(n, i, s)
                }, s)
            }
            )
        }
        ,
        t.prototype.many = function() {
            var e = this;
            return new t(function(t, n, r) {
                for (var i = []; e._(t, o, s); )
                    ;
                return n(t, i);
                function o(e, n) {
                    return t = e,
                    i.push(n),
                    !0
                }
                function s() {
                    return !1
                }
            }
            )
        }
        ,
        t.prototype.times = function(e, n) {
            arguments.length < 2 && (n = e);
            var r = this;
            return new t(function(t, i, o) {
                for (var s, a = [], c = !0, l = 0; l < e; l += 1)
                    if (!(c = !!r._(t, p, u)))
                        return o(t, s);
                for (; l < n && c; l += 1)
                    r._(t, p, h);
                return i(t, a);
                function p(e, n) {
                    return a.push(n),
                    t = e,
                    !0
                }
                function u(e, n) {
                    return s = n,
                    t = e,
                    !1
                }
                function h(t, e) {
                    return !1
                }
            }
            )
        }
        ,
        t.prototype.result = function(e) {
            return this.then(t.succeed(e))
        }
        ,
        t.prototype.atMost = function(t) {
            return this.times(0, t)
        }
        ,
        t.prototype.atLeast = function(t) {
            var e = this;
            return e.times(t).then(function(t) {
                return e.many().map(function(e) {
                    return t.concat(e)
                })
            })
        }
        ,
        t.prototype.map = function(e) {
            return this.then(function(n) {
                return t.succeed(e(n))
            })
        }
        ,
        t.prototype.skip = function(t) {
            return this.then(function(e) {
                return t.result(e)
            })
        }
        ,
        t.string = function(e) {
            var n = e.length
              , r = "expected '" + e + "'";
            return new t(function(t, i, o) {
                var s = t.slice(0, n);
                return s === e ? i(t.slice(n), s) : o(t, r)
            }
            )
        }
        ,
        t.regex = function(e) {
            o("regexp parser is anchored", "^" === e.toString().charAt(1));
            var n = "expected " + e;
            return new t(function(t, r, i) {
                var o = e.exec(t);
                if (o) {
                    var s = o[0];
                    return r(t.slice(s.length), s)
                }
                return i(t, n)
            }
            )
        }
        ,
        t.succeed = function(e) {
            return new t(function(t, n) {
                return n(t, e)
            }
            )
        }
        ,
        t.fail = function(e) {
            return new t(function(t, n, r) {
                return r(t, e)
            }
            )
        }
        ,
        t.letter = t.regex(/^[a-z]/i),
        t.letters = t.regex(/^[a-z]*/i),
        t.digit = t.regex(/^[0-9]/),
        t.digits = t.regex(/^[0-9]*/),
        t.whitespace = t.regex(/^\s+/),
        t.optWhitespace = t.regex(/^\s*/),
        t.any = new t(function(t, e, n) {
            return t ? e(t.slice(1), t.charAt(0)) : n(t, "expected any character")
        }
        ),
        t.all = new t(function(t, e, n) {
            return e("", t)
        }
        ),
        t.eof = new t(function(t, e, n) {
            return t ? n(t, "expected EOF") : e(t, t)
        }
        ),
        t
    }()
      , M = function() {
        var t = {
            8: "Backspace",
            9: "Tab",
            10: "Enter",
            13: "Enter",
            16: "Shift",
            17: "Control",
            18: "Alt",
            20: "CapsLock",
            27: "Esc",
            32: "Spacebar",
            33: "PageUp",
            34: "PageDown",
            35: "End",
            36: "Home",
            37: "Left",
            38: "Up",
            39: "Right",
            40: "Down",
            45: "Insert",
            46: "Del",
            144: "NumLock"
        };
        function n(e) {
            var n, r = e.which || e.keyCode, i = t[r], o = [];
            return e.ctrlKey && o.push("Ctrl"),
            e.originalEvent && e.originalEvent.metaKey && o.push("Meta"),
            e.altKey && o.push("Alt"),
            e.shiftKey && o.push("Shift"),
            n = i || String.fromCharCode(r),
            o.length || i ? (o.push(n),
            o.join("-")) : n
        }
        return function(t, r) {
            var o, s = null, a = null, c = e(t), l = e(r.container || c), p = i;
            function u(t) {
                p = t,
                clearTimeout(o),
                o = setTimeout(t)
            }
            function h(t) {
                u(function(e) {
                    p = i,
                    clearTimeout(o),
                    t(e)
                })
            }
            function f() {
                try {
                    c[0].select()
                } catch (t) {}
            }
            l.bind("keydown keypress input keyup paste", function(t) {
                p(t)
            });
            var d = !1;
            function m() {
                r.options && r.options.overrideKeystroke ? r.options.overrideKeystroke(n(s), s) : r.keystroke(n(s), s)
            }
            function g(t) {
                t.target === c[0] && (s = t,
                a = null,
                d && h(function(t) {
                    t && "focusout" === t.type || f()
                }),
                m())
            }
            function v(t) {
                if (!t || !t.originalEvent)
                    return !1;
                switch (t.originalEvent.key) {
                case "ArrowRight":
                case "ArrowLeft":
                case "ArrowDown":
                case "ArrowUp":
                    return !0
                }
                return !1
            }
            function y(t) {
                t.target === c[0] && (s && a && m(),
                a = t,
                v(t) || u(w))
            }
            function b(t) {
                t.target === c[0] && s && !a && (v(t) || u(w))
            }
            function w() {
                if (!("selectionStart"in (t = c[0])) || t.selectionStart === t.selectionEnd) {
                    var t, e = c.val();
                    1 === e.length ? (c.val(""),
                    r.options && r.options.overrideTypedText ? r.options.overrideTypedText(e) : r.typedText(e)) : e && f()
                }
            }
            function q() {
                s = null,
                a = null,
                p = i,
                clearTimeout(o),
                c.val("")
            }
            function x() {
                var t = c.val();
                c.val(""),
                t && r.paste(t)
            }
            return r.options && r.options.disableCopyPaste ? l.bind({
                keydown: g,
                keypress: y,
                keyup: b,
                focusout: q,
                copy: function(t) {
                    t.preventDefault()
                },
                cut: function(t) {
                    t.preventDefault()
                },
                paste: function(t) {
                    t.preventDefault()
                }
            }) : l.bind({
                keydown: g,
                keypress: y,
                keyup: b,
                focusout: q,
                cut: function() {
                    h(function() {
                        r.cut()
                    })
                },
                copy: function() {
                    h(function() {
                        r.copy()
                    })
                },
                paste: function(t) {
                    t.target === c[0] && (document.activeElement !== c[0] && c[0].focus(),
                    u(x))
                }
            }),
            {
                select: function(t) {
                    p(),
                    p = i,
                    clearTimeout(o),
                    c.val(t),
                    t && f(),
                    d = !!t
                }
            }
        }
    }()
      , N = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.exportText = function() {
            return this.root.foldChildren("", function(t, e) {
                return t + e.text()
            })
        }
        ,
        e
    }(x);
    x.onNotify(function(t, e) {
        if ("edit" === e || "replace" === e || void 0 === e) {
            var n = t.controller;
            if (!n)
                return;
            if (!n.options.enableDigitGrouping)
                return;
            if (!1 !== n.blurred)
                return;
            n.disableGroupingForSeconds(1)
        }
    });
    var R = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.disableGroupingForSeconds = function(t) {
            clearTimeout(this.__disableGroupingTimeout);
            var e = this.root.jQ;
            0 === t ? e.removeClass("dcg-mq-suppress-grouping") : (e.addClass("dcg-mq-suppress-grouping"),
            this.__disableGroupingTimeout = setTimeout(function() {
                e.removeClass("dcg-mq-suppress-grouping")
            }, 1e3 * t))
        }
        ,
        e.prototype.focusBlurEvents = function() {
            var t, e = this, n = e.root, r = e.cursor;
            function i() {
                clearTimeout(t),
                r.selection && r.selection.jQ.addClass("dcg-mq-blur"),
                o(),
                e.updateMathspeak()
            }
            function o() {
                r.hide().parent.blur(r),
                e.container.removeClass("dcg-mq-focused"),
                c(window).unbind("blur", i),
                e.options && e.options.resetCursorOnBlur && r.resetToEnd(e)
            }
            e.getTextareaOrThrow().focus(function() {
                e.updateMathspeak(),
                e.blurred = !1,
                clearTimeout(t),
                e.container.addClass("dcg-mq-focused"),
                r.parent || r.insAtRightEnd(n),
                r.selection ? (r.selection.jQ.removeClass("dcg-mq-blur"),
                e.selectionChanged()) : r.show(),
                e.setOverflowClasses()
            }).blur(function() {
                e.textareaSelectionTimeout && (clearTimeout(e.textareaSelectionTimeout),
                e.textareaSelectionTimeout = 0),
                e.disableGroupingForSeconds(0),
                e.blurred = !0,
                t = setTimeout(function() {
                    n.postOrder(function(t) {
                        t.intentionalBlur()
                    }),
                    r.clearSelection().endSelection(),
                    o(),
                    e.updateMathspeak(),
                    e.scrollHoriz()
                }),
                c(window).bind("blur", i)
            }),
            e.blurred = !0,
            r.hide().parent.blur(r)
        }
        ,
        e.prototype.unbindFocusBlurEvents = function() {
            this.getTextareaOrThrow().unbind("focus blur")
        }
        ,
        e
    }(N)
      , z = !1
      , F = function(e) {
        function n() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(n, e),
        n.prototype.keystroke = function(e, r, i) {
            var o = i.cursor;
            switch (e) {
            case "Ctrl-Shift-Backspace":
            case "Ctrl-Backspace":
                i.ctrlDeleteDir(t);
                break;
            case "Shift-Backspace":
            case "Backspace":
                i.backspace();
                break;
            case "Esc":
            case "Tab":
                return void i.escapeDir(1, e, r);
            case "Shift-Tab":
            case "Shift-Esc":
                return void i.escapeDir(t, e, r);
            case "End":
                i.notify("move").cursor.insAtRightEnd(o.parent),
                i.aria.queue("end of").queue(o.parent, !0);
                break;
            case "Ctrl-End":
                i.notify("move").cursor.insAtRightEnd(i.root),
                i.aria.queue("end of").queue(i.ariaLabel).queue(i.root).queue(i.ariaPostLabel);
                break;
            case "Shift-End":
                i.selectToBlockEndInDir(1);
                break;
            case "Ctrl-Shift-End":
                i.selectToRootEndInDir(1);
                break;
            case "Home":
                i.notify("move").cursor.insAtLeftEnd(o.parent),
                i.aria.queue("beginning of").queue(o.parent, !0);
                break;
            case "Ctrl-Home":
                i.notify("move").cursor.insAtLeftEnd(i.root),
                i.aria.queue("beginning of").queue(i.ariaLabel).queue(i.root).queue(i.ariaPostLabel);
                break;
            case "Shift-Home":
                i.selectToBlockEndInDir(t);
                break;
            case "Ctrl-Shift-Home":
                i.selectToRootEndInDir(t);
                break;
            case "Left":
                i.moveLeft();
                break;
            case "Shift-Left":
                i.selectLeft();
                break;
            case "Ctrl-Left":
                break;
            case "Right":
                i.moveRight();
                break;
            case "Shift-Right":
                i.selectRight();
                break;
            case "Ctrl-Right":
                break;
            case "Up":
                i.moveUp();
                break;
            case "Down":
                i.moveDown();
                break;
            case "Shift-Up":
                i.withIncrementalSelection(function(e) {
                    if (o[t])
                        for (; o[t]; )
                            e(t);
                    else
                        e(t)
                });
                break;
            case "Shift-Down":
                i.withIncrementalSelection(function(t) {
                    if (o[1])
                        for (; o[1]; )
                            t(1);
                    else
                        t(1)
                });
                break;
            case "Ctrl-Up":
            case "Ctrl-Down":
                break;
            case "Ctrl-Shift-Del":
            case "Ctrl-Del":
                i.ctrlDeleteDir(1);
                break;
            case "Shift-Del":
            case "Del":
                i.deleteForward();
                break;
            case "Meta-A":
            case "Ctrl-A":
                i.selectAll();
                break;
            case "Ctrl-Alt-Up":
                o.parent.parent && o.parent.parent instanceof n ? i.aria.queue(o.parent.parent) : i.aria.queue("nothing above");
                break;
            case "Ctrl-Alt-Down":
                o.parent && o.parent instanceof n ? i.aria.queue(o.parent) : i.aria.queue("block is empty");
                break;
            case "Ctrl-Alt-Left":
                o.parent.parent && o.parent.parent.getEnd(t) ? i.aria.queue(o.parent.parent.getEnd(t)) : i.aria.queue("nothing to the left");
                break;
            case "Ctrl-Alt-Right":
                o.parent.parent && o.parent.parent.getEnd(1) ? i.aria.queue(o.parent.parent.getEnd(1)) : i.aria.queue("nothing to the right");
                break;
            case "Ctrl-Alt-Shift-Down":
                o.selection ? i.aria.queue(o.selection.join("mathspeak", " ").trim() + " selected") : i.aria.queue("nothing selected");
                break;
            case "Ctrl-Alt-=":
            case "Ctrl-Alt-Shift-Right":
                i.ariaPostLabel.length ? i.aria.queue(i.ariaPostLabel) : i.aria.queue("no answer");
                break;
            default:
                return
            }
            i.aria.alert(),
            r.preventDefault(),
            i.scrollHoriz()
        }
        ,
        n.prototype.moveOutOf = function(t, e, n) {
            o("overridden or never called on this node", !1)
        }
        ,
        n.prototype.moveTowards = function(t, e, n) {
            o("overridden or never called on this node", !1)
        }
        ,
        n.prototype.deleteOutOf = function(t, e) {
            o("overridden or never called on this node", !1)
        }
        ,
        n.prototype.deleteTowards = function(t, e) {
            o("overridden or never called on this node", !1)
        }
        ,
        n.prototype.unselectInto = function(t, e) {
            o("overridden or never called on this node", !1)
        }
        ,
        n.prototype.selectOutOf = function(t, e) {
            o("overridden or never called on this node", !1)
        }
        ,
        n.prototype.selectTowards = function(t, e) {
            o("overridden or never called on this node", !1)
        }
        ,
        n
    }(f);
    x.onNotify(function(t, e) {
        "move" !== e && "upDown" !== e || t.show().clearSelection()
    }),
    E.leftRightIntoCmdGoes = function(t) {
        if (t && "up" !== t && "down" !== t)
            throw '"up" or "down" required for leftRightIntoCmdGoes option, got "' + t + '"';
        return t
    }
    ,
    x.onNotify(function(t, e) {
        "upDown" !== e && (t.upDownCache = {})
    }),
    x.onNotify(function(t, e) {
        "edit" === e && t.show().deleteSelection()
    }),
    x.onNotify(function(t, e) {
        "select" !== e && t.endSelection()
    });
    var P = function(e) {
        function n() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(n, e),
        n.prototype.keystroke = function(t, e) {
            this.cursor.parent.keystroke(t, e, this.getControllerSelf())
        }
        ,
        n.prototype.escapeDir = function(t, e, n) {
            s(t);
            var r = this.cursor;
            if (r.parent !== this.root && n.preventDefault(),
            r.parent !== this.root)
                return r.parent.moveOutOf(t, r),
                r.controller.aria.alert(),
                this.notify("move")
        }
        ,
        n.prototype.moveDir = function(t) {
            s(t);
            var e = this.cursor
              , n = e.options.leftRightIntoCmdGoes
              , r = e[t];
            return e.selection ? e.insDirOf(t, e.selection.getEnd(t)) : r ? r.moveTowards(t, e, n) : e.parent.moveOutOf(t, e, n),
            this.notify("move")
        }
        ,
        n.prototype.moveLeft = function() {
            return this.moveDir(t)
        }
        ,
        n.prototype.moveRight = function() {
            return this.moveDir(1)
        }
        ,
        n.prototype.moveUp = function() {
            return this.moveUpDown("up")
        }
        ,
        n.prototype.moveDown = function() {
            return this.moveUpDown("down")
        }
        ,
        n.prototype.moveUpDown = function(e) {
            var n, r, i = this.notify("upDown").cursor;
            "up" === e ? (n = "upInto",
            r = "upOutOf") : (n = "downInto",
            r = "downOutOf");
            var o = i[t]
              , s = i[1]
              , a = s && s[n]
              , c = o && o[n];
            return a ? i.insAtLeftEnd(a) : c ? i.insAtRightEnd(c) : i.parent.bubble(function(t) {
                var e = t[r];
                if (e && ("function" == typeof e && (e = e.call(t, i)),
                e instanceof F && i.jumpUpDown(t, e),
                !0 !== e))
                    return !1
            }),
            this
        }
        ,
        n.prototype.deleteDir = function(e) {
            s(e);
            var n = this.cursor
              , r = n[e]
              , i = n.parent.parent
              , o = n.controller;
            if (r && r instanceof F)
                r.sides ? o.aria.queue(r.parent.chToCmd(r.sides[-e].ch).mathspeak({
                    createdLeftOf: n
                })) : r.blocks || "\\text" === r.parent.ctrlSeq || o.aria.queue(r);
            else if (i && i instanceof F)
                if (i.sides)
                    o.aria.queue(i.parent.chToCmd(i.sides[e].ch).mathspeak({
                        createdLeftOf: n
                    }));
                else if (i.blocks && i.mathspeakTemplate)
                    if (i.upInto && i.downInto)
                        o.aria.queue(i.mathspeakTemplate[1]);
                    else {
                        var a = i.mathspeakTemplate
                          , c = e === t ? a[0] : a[a.length - 1];
                        o.aria.queue(c)
                    }
                else
                    o.aria.queue(i);
            var l = n.selection;
            if (this.notify("edit"),
            !l) {
                var p = n[e];
                p ? p.deleteTowards(e, n) : n.parent.deleteOutOf(e, n)
            }
            var u = n[t]
              , h = n[1];
            return u.siblingDeleted && u.siblingDeleted(n.options, 1),
            h.siblingDeleted && h.siblingDeleted(n.options, t),
            n.parent.bubble(function(t) {
                t.reflow()
            }),
            this
        }
        ,
        n.prototype.ctrlDeleteDir = function(e) {
            s(e);
            var n, r = this.cursor;
            if (!r[e] || r.selection)
                return this.deleteDir(e);
            this.notify("edit"),
            n = e === t ? new m(r.parent.getEnd(t),r[t]) : new m(r[1],r.parent.getEnd(1)),
            r.controller.aria.queue(n),
            n.remove(),
            r.insAtDirEnd(e, r.parent);
            var i = r[t]
              , o = r[1];
            return i && i.siblingDeleted(r.options, 1),
            o && o.siblingDeleted(r.options, t),
            r.parent.bubble(function(t) {
                t.reflow()
            }),
            this
        }
        ,
        n.prototype.backspace = function() {
            return this.deleteDir(t)
        }
        ,
        n.prototype.deleteForward = function() {
            return this.deleteDir(1)
        }
        ,
        n.prototype.startIncrementalSelection = function() {
            o("Multiple selections can't be simultaneously open", !z),
            z = !0,
            this.notify("select");
            var t = this.cursor;
            t.anticursor || t.startSelection()
        }
        ,
        n.prototype.selectDirIncremental = function(t) {
            o("A selection is open", z),
            z = !0;
            var e = this.cursor
              , n = e.selection;
            s(t);
            var r = e[t];
            r ? n && n.getEnd(t) === r && e.anticursor[-t] !== r ? r.unselectInto(t, e) : r.selectTowards(t, e) : e.parent.selectOutOf(t, e)
        }
        ,
        n.prototype.finishIncrementalSelection = function() {
            o("A selection is open", z);
            var t = this.cursor;
            t.clearSelection(),
            t.select() || t.show();
            var e = t.selection;
            e && t.controller.aria.clear().queue(e.join("mathspeak", " ").trim() + " selected"),
            z = !1
        }
        ,
        n.prototype.withIncrementalSelection = function(t) {
            var e = this;
            try {
                this.startIncrementalSelection();
                try {
                    t(function(t) {
                        return e.selectDirIncremental(t)
                    })
                } finally {
                    this.finishIncrementalSelection()
                }
            } finally {
                z = !1
            }
        }
        ,
        n.prototype.selectDir = function(t) {
            this.withIncrementalSelection(function(e) {
                return e(t)
            })
        }
        ,
        n.prototype.selectLeft = function() {
            return this.selectDir(t)
        }
        ,
        n.prototype.selectRight = function() {
            return this.selectDir(1)
        }
        ,
        n.prototype.selectAll = function() {
            this.notify("move");
            var e = this.cursor;
            e.insAtRightEnd(this.root),
            this.withIncrementalSelection(function(n) {
                for (; e[t]; )
                    n(t)
            })
        }
        ,
        n.prototype.selectToBlockEndInDir = function(t) {
            var e = this.cursor;
            this.withIncrementalSelection(function(n) {
                for (; e[t]; )
                    n(t)
            })
        }
        ,
        n.prototype.selectToRootEndInDir = function(t) {
            var e = this
              , n = this.cursor;
            this.withIncrementalSelection(function(r) {
                for (; n[t] || n.parent !== e.root; )
                    r(t)
            })
        }
        ,
        n
    }(R)
      , $ = (function(t) {
        function e(e) {
            return t.call(this) || this
        }
        __extends(e, t)
    }(F),
    function() {
        function t(t) {
            for (var e = t[0] || new nt, n = 1; n < t.length; n += 1)
                t[n].children().adopt(e, e.getEnd(1), 0);
            return e
        }
        var e = B.string
          , n = B.regex
          , r = B.letter
          , i = B.digit
          , o = B.any
          , s = B.optWhitespace
          , a = B.succeed
          , c = B.fail
          , l = r.map(function(t) {
            return new ct(t)
        })
          , p = i.map(function(t) {
            return new ot(t)
        })
          , u = n(/^[^${}\\_^]/).map(function(t) {
            return new X(t)
        })
          , h = n(/^[^\\a-eg-zA-Z]/).or(e("\\").then(n(/^[a-z]+/i).or(n(/^\s+/).result(" ")).or(o))).then(function(t) {
            var e = g[t];
            return e ? e.constructor ? new e(t).parser() : e(t).parser() : c("unknown command: \\" + t)
        }).or(l).or(p).or(u)
          , f = e("{").then(function() {
            return m
        }).skip(e("}"))
          , d = s.then(f.or(h.map(function(t) {
            var e = new nt;
            return t.adopt(e, 0, 0),
            e
        })))
          , m = d.many().map(t).skip(s)
          , v = e("[").then(d.then(function(t) {
            return "]" !== t.join("latex") ? a(t) : c("")
        }).many().map(t).skip(s)).skip(e("]"))
          , y = m;
        return y.block = d,
        y.optBlock = v,
        y
    }());
    E.maxDepth = function(t) {
        return "number" == typeof t ? t : void 0
    }
    ;
    var G, H = function(e) {
        function n() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(n, e),
        n.prototype.cleanLatex = function(t) {
            return t.replace(/(\\[a-z]+) (?![a-z])/gi, "$1")
        }
        ,
        n.prototype.exportLatex = function() {
            return this.cleanLatex(this.root.latex())
        }
        ,
        n.prototype.writeLatex = function(t) {
            var e = this.notify("edit").cursor;
            return e.parent.writeLatex(e, t),
            this
        }
        ,
        n.prototype.classifyLatexForEfficientUpdate = function(t) {
            if ("string" == typeof t) {
                var e = t.match(/-?[0-9.]+$/g);
                return e && 1 === e.length ? {
                    latex: t,
                    prefix: t.substr(0, t.length - e[0].length),
                    digits: e[0]
                } : void 0
            }
        }
        ,
        n.prototype.renderLatexMathEfficiently = function(e) {
            var n, r, i, o, s, a = this.root, l = this.exportLatex();
            if (a.getEnd(t) && a.getEnd(1) && l === e)
                return !0;
            var p = this.classifyLatexForEfficientUpdate(e);
            if (!p)
                return !1;
            if (!(s = this.classifyLatexForEfficientUpdate(l)) || s.prefix !== p.prefix)
                return !1;
            var u = s.digits
              , h = p.digits
              , f = !1
              , d = !1;
            "-" === u[0] && (f = !0,
            u = u.substr(1)),
            "-" === h[0] && (d = !0,
            h = h.substr(1));
            for (var m = this.root.getEnd(1), g = [], v = u.length - 1; v >= 0; v--) {
                if (!m || m.ctrlSeq !== u[v])
                    return !1;
                if (m.parent !== a)
                    return !1;
                g.unshift(m),
                m = m[t]
            }
            if (f && !d) {
                var y = m;
                if (!y)
                    return !1;
                if ("-" !== y.ctrlSeq)
                    return !1;
                if (y[1] !== g[0])
                    return !1;
                if (y.parent !== a)
                    return !1;
                var b = y[t];
                if (b && b.parent !== a)
                    return !1;
                g[0][t] = y[t],
                a.getEnd(t) === y && a.setEnds(((n = {})[t] = g[0],
                n[1] = a.getEnd(1),
                n)),
                b && (b[1] = g[0]),
                y.jQ.remove()
            }
            if (!f && d) {
                var w = new vt("-")
                  , q = document.createElement("span");
                q.textContent = "-",
                w.jQ = c(q);
                var x = g[0][t];
                x && (x[1] = w),
                a.getEnd(t) === g[0] && a.setEnds(((r = {})[t] = w,
                r[1] = a.getEnd(1),
                r)),
                w.parent = a,
                w[t] = g[0][t],
                w[1] = g[0],
                g[0][t] = w,
                w.contactWeld(this.cursor),
                w.jQ.insertBefore(g[0].jQ)
            }
            var k = Math.min(u.length, h.length);
            for (v = 0; v < k; v++) {
                var _ = h[v];
                (m = g[v]).ctrlSeq !== _ && (m.ctrlSeq = _,
                m.jQ[0].textContent = _,
                m.mathspeakName = _)
            }
            if (u.length > h.length)
                for (m = g[h.length - 1],
                a.setEnds(((i = {})[t] = a.getEnd(t),
                i[1] = m,
                i)),
                m[1] = 0,
                v = u.length - 1; v >= k; v--)
                    g[v].jQ.remove();
            if (h.length > u.length) {
                var E = document.createDocumentFragment();
                for (v = k; v < h.length; v++) {
                    var S = document.createElement("span");
                    S.className = "dcg-mq-digit",
                    S.textContent = h[v];
                    var O = new ot(h[v]);
                    O.parent = a,
                    O.jQ = c(S),
                    E.appendChild(S),
                    O[t] = a.getEnd(1),
                    O[1] = 0,
                    O[t][1] = O,
                    a.setEnds(((o = {})[t] = a.getEnd(t),
                    o[1] = O,
                    o))
                }
                a.jQ[0].appendChild(E)
            }
            var L = this.exportLatex();
            if (L !== e)
                return console.warn("tried updating latex efficiently but did not work. Attempted: " + e + " but wrote: " + L),
                !1;
            this.cursor.resetToEnd(this);
            var T = a.getEnd(1);
            return T && T.fixDigitGrouping(this.cursor.options),
            !0
        }
        ,
        n.prototype.renderLatexMathFromScratch = function(e) {
            var n, r = this.root, i = this.cursor, o = B.all, s = B.eof, a = $.skip(s).or(o.result(!1)).parse(e);
            r.setEnds(((n = {})[t] = 0,
            n[1] = 0,
            n)),
            a && a.children().adopt(r, 0, 0);
            var c = r.jQ;
            if (a) {
                var l = a.join("html");
                c.html(l),
                r.jQize(c.children()),
                r.finalizeInsert(i.options, i)
            } else
                c.empty();
            this.updateMathspeak(),
            delete i.selection,
            i.insAtRightEnd(r)
        }
        ,
        n.prototype.renderLatexMath = function(t) {
            this.notify("replace"),
            this.renderLatexMathEfficiently(t) || this.renderLatexMathFromScratch(t)
        }
        ,
        n.prototype.renderLatexText = function(e) {
            var n, r = this.root, i = this.cursor;
            r.jQ.children().slice(1).remove(),
            r.setEnds(((n = {})[t] = 0,
            n[1] = 0,
            n)),
            delete i.selection,
            i.show().insAtRightEnd(r);
            var o = B.regex
              , s = B.string
              , a = B.eof
              , c = B.all
              , l = s("$").then($).skip(s("$").or(a)).map(function(e) {
                var n = new RootMathCommand(i);
                n.createBlocks();
                var r = n.getEnd(t);
                return e.children().adopt(r, 0, 0),
                n
            })
              , p = s("\\$").result("$").or(o(/^[^$]/)).map(function(t) {
                return new X(t)
            })
              , u = l.or(p).many().skip(a).or(c.result(!1)).parse(e);
            if (u) {
                for (var h = 0; h < u.length; h += 1)
                    u[h].adopt(r, r.getEnd(1), 0);
                r.jQize().appendTo(r.jQ),
                r.finalizeInsert(i.options, i)
            }
        }
        ,
        n
    }(P), U = function(t) {
        return !1
    };
    S.prototype.ignoreNextMousedown = U,
    x.onNotify(function(t, e) {
        "edit" !== e && "replace" !== e || G && G.cursor === t && G.cb()
    });
    var W = function(e) {
        function n() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(n, e),
        n.prototype.setOverflowClasses = function() {
            var t = this.root.jQ[0]
              , e = !1
              , n = !1;
            if (!this.blurred) {
                var r = t.getBoundingClientRect().width
                  , i = t.scrollWidth
                  , o = t.scrollLeft;
                e = i > r + o,
                n = o > 0
            }
            t.classList.contains("dcg-mq-editing-overflow-right") !== e && t.classList.toggle("dcg-mq-editing-overflow-right"),
            t.classList.contains("dcg-mq-editing-overflow-left") !== n && t.classList.toggle("dcg-mq-editing-overflow-left")
        }
        ,
        n.prototype.scrollHoriz = function() {
            var e = this
              , n = this.cursor
              , r = n.selection
              , i = this.root.jQ[0].getBoundingClientRect();
            if (n.jQ[0] || r) {
                if (r) {
                    var o = r.jQ[0].getBoundingClientRect()
                      , s = o.left - (i.left + 20)
                      , a = o.right - (i.right - 20);
                    if (r.getEnd(t) === n[1])
                        if (s < 0)
                            l = s;
                        else {
                            if (!(a > 0))
                                return;
                            if (o.left - a < i.left + 20)
                                l = s;
                            else
                                l = a
                        }
                    else if (a > 0)
                        l = a;
                    else {
                        if (!(s < 0))
                            return;
                        if (o.right - s > i.right - 20)
                            l = a;
                        else
                            l = s
                    }
                } else {
                    var c = n.jQ[0].getBoundingClientRect().left;
                    if (c > i.right - 20)
                        var l = c - (i.right - 20);
                    else {
                        if (!(c < i.left + 20))
                            return;
                        var l = c - (i.left + 20)
                    }
                }
                var p = this.root.jQ[0];
                l < 0 && 0 === p.scrollLeft || l > 0 && p.scrollWidth <= p.scrollLeft + i.width || this.root.jQ.stop().animate({
                    scrollLeft: "+=" + l
                }, 100, function() {
                    e.setOverflowClasses()
                })
            } else
                this.root.jQ.stop().animate({
                    scrollLeft: 0
                }, 100, function() {
                    e.setOverflowClasses()
                })
        }
        ,
        n
    }(function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.delegateMouseEvents = function() {
            var t = this.root.jQ;
            this.container.bind("mousedown.mathquill", function(e) {
                var n, r, o = e, s = c(o.target).closest(".dcg-mq-root-block"), a = (f.getNodeOfElement(s[0]) || f.getNodeOfElement(t[0])).controller, l = a.cursor, p = l.blink, u = a.getTextareaSpanOrThrow(), h = a.getTextareaOrThrow();
                if ((o.preventDefault(),
                o.target.unselectable = !0,
                !l.options.ignoreNextMousedown(o)) && (l.options.ignoreNextMousedown = U,
                G = {
                    cursor: l,
                    cb: function() {
                        r = !0,
                        l.blink = p,
                        l.clearSelection(),
                        y(),
                        v(o)
                    }
                },
                !a.blurred || (a.editable || s.prepend(u),
                h[0].focus(),
                !r))) {
                    l.blink = i,
                    a.seek(c(o.target), o.pageX, o.pageY).cursor.startSelection(),
                    s.mousemove(m);
                    var d = o.target;
                    c(d.ownerDocument).mousemove(g).mouseup(b)
                }
                function m(t) {
                    n = c(t.target)
                }
                function g(t) {
                    l.anticursor || l.startSelection(),
                    a.seek(n, t.pageX, t.pageY).cursor.select(),
                    l.selection && l.controller.aria.clear().queue(l.selection.join("mathspeak") + " selected").alert(),
                    n = void 0
                }
                function v(t) {
                    s.unbind("mousemove", m);
                    var e = t.target;
                    c(e.ownerDocument).unbind("mousemove", g).unbind("mouseup", b),
                    G = void 0
                }
                function y() {
                    a.editable ? (l.show(),
                    l.controller.aria.queue(l.parent).alert()) : u.detach()
                }
                function b(t) {
                    l.blink = p,
                    l.selection || y(),
                    v(t)
                }
            })
        }
        ,
        e.prototype.seek = function(t, e, n) {
            for (var r, i = this.notify("select").cursor, o = t && t[0]; o && !(r = f.getNodeOfElement(o)); )
                o = o.parentElement;
            return r || (r = this.root),
            i.clearSelection().show(),
            r.seek(e, i),
            this.scrollHoriz(),
            this
        }
        ,
        e
    }(H));
    S.prototype.substituteTextarea = function() {
        return c("<textarea autocapitalize=off autocomplete=off autocorrect=off spellcheck=false x-palm-disable-ste-all=true/>")[0]
    }
    ,
    S.prototype.substituteKeyboardEvents = M;
    var V = function(t) {
        function n() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(n, t),
        n.prototype.createTextarea = function() {
            var t = this.textareaSpan = c('<span class="dcg-mq-textarea"></span>')
              , e = this.options.substituteTextarea();
            if (!e.nodeType)
                throw "substituteTextarea() must return a DOM element, got " + e;
            this.textarea = c(e).appendTo(t);
            var n = this;
            n.cursor.selectionChanged = function() {
                n.selectionChanged()
            }
        }
        ,
        n.prototype.selectionChanged = function() {
            var t = this;
            t.textareaSelectionTimeout || (t.textareaSelectionTimeout = setTimeout(function() {
                t.setTextareaSelection()
            }))
        }
        ,
        n.prototype.setTextareaSelection = function() {
            this.textareaSelectionTimeout = 0;
            var t = "";
            this.cursor.selection && (t = this.cleanLatex(this.cursor.selection.join("latex")),
            this.options.statelessClipboard && (t = "$" + t + "$")),
            this.selectFn(t)
        }
        ,
        n.prototype.staticMathTextareaEvents = function() {
            var t = this
              , n = t.cursor
              , r = t.getTextareaOrThrow()
              , i = t.getTextareaSpanOrThrow();
            function o() {
                i.detach(),
                t.blurred = !0
            }
            this.container.prepend(e('<span aria-hidden="true" class="dcg-mq-selectable">').text("$" + t.exportLatex() + "$")),
            this.mathspeakSpan = c('<span class="dcg-mq-mathspeak"></span>'),
            this.container.prepend(this.mathspeakSpan),
            t.blurred = !0,
            r.bind("cut paste", !1),
            t.options.disableCopyPaste ? r.bind("copy", !1) : r.bind("copy", function() {
                t.setTextareaSelection()
            }),
            r.focus(function() {
                t.blurred = !1
            }).blur(function() {
                n.selection && n.selection.clear(),
                setTimeout(o)
            }),
            t.selectFn = function(t) {
                r.val(t),
                t && r.select()
            }
            ,
            this.updateMathspeak()
        }
        ,
        n.prototype.editablesTextareaEvents = function() {
            var t = this.getTextareaOrThrow()
              , e = this.getTextareaSpanOrThrow()
              , n = this.options.substituteKeyboardEvents(t, this);
            this.selectFn = function(t) {
                n.select(t)
            }
            ,
            this.container.prepend(e),
            this.focusBlurEvents(),
            this.updateMathspeak()
        }
        ,
        n.prototype.unbindEditablesEvents = function() {
            var t = this
              , e = t.getTextareaOrThrow()
              , n = t.getTextareaSpanOrThrow();
            this.selectFn = function(t) {
                e.val(t),
                t && e.select()
            }
            ,
            n.remove(),
            this.unbindFocusBlurEvents(),
            t.blurred = !0,
            e.bind("cut paste", !1)
        }
        ,
        n.prototype.typedText = function(t) {
            if ("\n" === t)
                return this.handle("enter");
            var e = this.notify(void 0).cursor;
            e.parent.write(e, t),
            this.scrollHoriz()
        }
        ,
        n.prototype.cut = function() {
            var t = this
              , e = t.cursor;
            e.selection && setTimeout(function() {
                t.notify("edit"),
                e.parent.bubble(function(t) {
                    t.reflow()
                }),
                t.options && t.options.onCut && t.options.onCut()
            })
        }
        ,
        n.prototype.copy = function() {
            this.setTextareaSelection()
        }
        ,
        n.prototype.paste = function(t) {
            this.options.statelessClipboard && (t = "$" === t.slice(0, 1) && "$" === t.slice(-1) ? t.slice(1, -1) : "\\text{" + t + "}"),
            this.writeLatex(t).cursor.show(),
            this.scrollHoriz(),
            this.options && this.options.onPaste && this.options.onPaste()
        }
        ,
        n.prototype.updateMathspeak = function() {
            var t = this
              , e = t.getAriaLabel()
              , n = /[A-Za-z0-9]$/.test(e) ? e + ":" : e
              , r = t.root.mathspeak().trim();
            this.aria.clear();
            var i = t.getTextareaOrThrow();
            t.mathspeakSpan ? (i.attr("aria-label", ""),
            t.mathspeakSpan.text((n + " " + r).trim())) : i.attr("aria-label", (n + " " + r + " " + t.ariaPostLabel).trim())
        }
        ,
        n
    }(W)
      , K = function(e) {
        function n() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(n, e),
        n.prototype.finalizeInsert = function(e, n) {
            var r = this;
            r.postOrder(function(t) {
                t.finalizeTree(e)
            }),
            r.postOrder(function(t) {
                t.contactWeld(n)
            }),
            r.postOrder(function(t) {
                t.blur(n)
            }),
            r.postOrder(function(t) {
                t.reflow()
            });
            var i = r[1]
              , o = r[t];
            i && i.siblingCreated(e, t),
            o && o.siblingCreated(e, 1),
            r.bubble(function(t) {
                t.reflow()
            })
        }
        ,
        n.prototype.prepareInsertionAt = function(t) {
            var e = t.options.maxDepth;
            if (void 0 !== e) {
                var n = t.depth();
                if (n > e)
                    return !1;
                this.removeNodesDeeperThan(e - n)
            }
            return !0
        }
        ,
        n.prototype.removeNodesDeeperThan = function(t) {
            for (var e, n = 0, r = [[this, n]]; e = r.shift(); ) {
                var i = e;
                i[0].children().each(function(e) {
                    var o = e instanceof nt ? 1 : 0;
                    (n = i[1] + o) <= t ? r.push([e, n]) : (o ? e.children() : e).remove()
                })
            }
        }
        ,
        n
    }(F)
      , Y = function(e) {
        function n(t, n, r) {
            var i = e.call(this) || this;
            return i.textTemplate = [""],
            i.mathspeakTemplate = [""],
            i.setCtrlSeqHtmlAndText(t, n, r),
            i
        }
        return __extends(n, e),
        n.prototype.setEnds = function(e) {
            o("MathCommand ends are never empty", e[t] && e[1]),
            this.ends = e
        }
        ,
        n.prototype.getEnd = function(t) {
            return this.ends[t]
        }
        ,
        n.prototype.setCtrlSeqHtmlAndText = function(t, e, n) {
            this.ctrlSeq || (this.ctrlSeq = t),
            e && (this.htmlTemplate = e),
            n && (this.textTemplate = n)
        }
        ,
        n.prototype.replaces = function(t) {
            t.disown(),
            this.replacedFragment = t
        }
        ,
        n.prototype.isEmpty = function() {
            return this.foldChildren(!0, function(t, e) {
                return t && e.isEmpty()
            })
        }
        ,
        n.prototype.parser = function() {
            var t = this;
            return $.block.times(this.numBlocks()).map(function(e) {
                t.blocks = e;
                for (var n = 0; n < e.length; n += 1)
                    e[n].adopt(t, t.getEnd(1), 0);
                return t
            })
        }
        ,
        n.prototype.createLeftOf = function(n) {
            var r = this
              , i = r.replacedFragment;
            if (r.createBlocks(),
            e.prototype.createLeftOf.call(this, n),
            i) {
                var o = r.getEnd(t);
                i.adopt(o, 0, 0),
                i.jQ.appendTo(o.jQ),
                r.placeCursor(n),
                r.prepareInsertionAt(n)
            }
            r.finalizeInsert(n.options, n),
            r.placeCursor(n)
        }
        ,
        n.prototype.createBlocks = function() {
            for (var t = this, e = t.numBlocks(), n = t.blocks = Array(e), r = 0; r < e; r += 1) {
                (n[r] = new nt).adopt(t, t.getEnd(1), 0)
            }
        }
        ,
        n.prototype.placeCursor = function(e) {
            e.insAtRightEnd(this.foldChildren(this.getEnd(t), function(t, e) {
                return t.isEmpty() ? t : e
            }))
        }
        ,
        n.prototype.moveTowards = function(t, e, n) {
            var r;
            "up" === n ? r = this.upInto : "down" === n && (r = this.downInto);
            var i = r || this.getEnd(-t);
            e.insAtDirEnd(-t, i),
            e.controller.aria.queueDirEndOf(-t).queue(e.parent, !0)
        }
        ,
        n.prototype.deleteTowards = function(t, e) {
            this.isEmpty() ? e[t] = this.remove()[t] : this.moveTowards(t, e)
        }
        ,
        n.prototype.selectTowards = function(t, e) {
            e[-t] = this,
            e[t] = this[t]
        }
        ,
        n.prototype.selectChildren = function() {
            return new q(this,this)
        }
        ,
        n.prototype.unselectInto = function(t, e) {
            var n = e.anticursor.ancestors[this.id];
            e.insAtDirEnd(-t, n)
        }
        ,
        n.prototype.seek = function(e, n) {
            function r(e) {
                var n, r = e.jQ.offset().left, i = r + e.jQ.outerWidth();
                return (n = {})[t] = r,
                n[1] = i,
                n
            }
            var i = this
              , o = r(i);
            if (e < o[t])
                return n.insLeftOf(i);
            if (e > o[1])
                return n.insRightOf(i);
            var s = o[t];
            i.eachChild(function(a) {
                var c = r(a);
                return e < c[t] ? (e - s < c[t] - e ? a[t] ? n.insAtRightEnd(a[t]) : n.insLeftOf(i) : n.insAtLeftEnd(a),
                !1) : e > c[1] ? void (a[1] ? s = c[1] : o[1] - e < e - c[1] ? n.insRightOf(i) : n.insAtRightEnd(a)) : (a.seek(e, n),
                !1)
            })
        }
        ,
        n.prototype.numBlocks = function() {
            var t = this.htmlTemplate.match(/&\d+/g);
            return t ? t.length : 0
        }
        ,
        n.prototype.html = function() {
            var t = this
              , e = t.blocks
              , n = " mathquill-command-id=" + t.id
              , r = t.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);
            o("no unmatched angle brackets", r.join("") === this.htmlTemplate);
            for (var i = 0, s = r[0]; s; s = r[i += 1])
                if ("/>" === s.slice(-2))
                    r[i] = s.slice(0, -2) + n + ' aria-hidden="true"/>';
                else if ("<" === s.charAt(0)) {
                    o("not an unmatched top-level close tag", "/" !== s.charAt(1)),
                    r[i] = s.slice(0, -1) + n + ' aria-hidden="true">';
                    var a = 1;
                    do {
                        o("no missing close tags", s = r[i += 1]),
                        "</" === s.slice(0, 2) ? a -= 1 : "<" === s.charAt(0) && "/>" !== s.slice(-2) && (a += 1)
                    } while (a > 0)
                }
            return r.join("").replace(/>&(\d+)/g, function(t, n) {
                var r = parseInt(n, 10);
                return " mathquill-block-id=" + e[r].id + ' aria-hidden="true">' + e[r].join("html")
            })
        }
        ,
        n.prototype.latex = function() {
            return this.foldChildren(this.ctrlSeq || "", function(t, e) {
                return t + "{" + (e.latex() || " ") + "}"
            })
        }
        ,
        n.prototype.text = function() {
            var t = this
              , e = 0;
            return t.foldChildren(t.textTemplate[e], function(n, r) {
                e += 1;
                var i = r.text();
                return n && "(" === t.textTemplate[e] && "(" === i[0] && ")" === i.slice(-1) ? n + i.slice(1, -1) + t.textTemplate[e] : n + i + (t.textTemplate[e] || "")
            })
        }
        ,
        n.prototype.mathspeak = function() {
            var t = this
              , e = 0;
            return t.foldChildren(t.mathspeakTemplate[e] || "Start" + t.ctrlSeq + " ", function(n, r) {
                return e += 1,
                n + " " + r.mathspeak() + " " + (t.mathspeakTemplate[e] + " " || "End" + t.ctrlSeq + " ")
            })
        }
        ,
        n
    }(K)
      , Z = function(t) {
        function e(e, n, r, i) {
            var o = t.call(this) || this;
            return o.setCtrlSeqHtmlTextAndMathspeak(e, n, r, i),
            o
        }
        return __extends(e, t),
        e.prototype.setCtrlSeqHtmlTextAndMathspeak = function(e, n, r, i) {
            !r && e && (r = e.replace(/^\\/, "")),
            this.mathspeakName = i || r,
            t.prototype.setCtrlSeqHtmlAndText.call(this, e, n, [r || ""])
        }
        ,
        e.prototype.parser = function() {
            return B.succeed(this)
        }
        ,
        e.prototype.numBlocks = function() {
            return 0
        }
        ,
        e.prototype.replaces = function(t) {
            t.remove()
        }
        ,
        e.prototype.createBlocks = function() {}
        ,
        e.prototype.moveTowards = function(t, e) {
            e.jQ.insDirOf(t, this.jQ),
            e[-t] = this,
            e[t] = this[t],
            e.controller.aria.queue(this)
        }
        ,
        e.prototype.deleteTowards = function(t, e) {
            e[t] = this.remove()[t]
        }
        ,
        e.prototype.seek = function(t, e) {
            return t - this.jQ.offset().left < this.jQ.outerWidth() / 2 ? e.insLeftOf(this) : e.insRightOf(this),
            e
        }
        ,
        e.prototype.latex = function() {
            return this.ctrlSeq || ""
        }
        ,
        e.prototype.text = function() {
            return this.textTemplate.join("")
        }
        ,
        e.prototype.mathspeak = function(t) {
            return this.mathspeakName || ""
        }
        ,
        e.prototype.placeCursor = function() {}
        ,
        e.prototype.isEmpty = function() {
            return !0
        }
        ,
        e
    }(Y)
      , X = function(t) {
        function e(e, n, r) {
            return t.call(this, e, "<span>" + (n || e) + "</span>", void 0, r) || this
        }
        return __extends(e, t),
        e
    }(Z);
    function J(t, e, n) {
        return function() {
            return new X(t,e,n)
        }
    }
    var tt = function(t) {
        function e(e, n, r, i, o) {
            return o ? t.call(this, e, "<span>" + (n || e) + "</span>", void 0, i) || this : t.call(this, e, '<span class="dcg-mq-binary-operator">' + n + "</span>", r, i) || this
        }
        return __extends(e, t),
        e
    }(Z);
    function et(t, e, n, r) {
        return function() {
            return new tt(t,e,n,r)
        }
    }
    var nt = function(e) {
        function n() {
            var t = null !== e && e.apply(this, arguments) || this;
            return t.ariaLabel = "block",
            t
        }
        return __extends(n, e),
        n.prototype.join = function(t) {
            return this.foldChildren("", function(e, n) {
                return e + n[t]()
            })
        }
        ,
        n.prototype.html = function() {
            return this.join("html")
        }
        ,
        n.prototype.latex = function() {
            return this.join("latex")
        }
        ,
        n.prototype.text = function() {
            var e = this.getEnd(t);
            return e === this.getEnd(1) && 0 !== e ? e.text() : this.join("text")
        }
        ,
        n.prototype.mathspeak = function() {
            var t = ""
              , e = {};
            return this.controller && (e = this.controller.options.autoOperatorNames),
            this.foldChildren([], function(n, r) {
                if (r.isPartOfOperator)
                    t += r.mathspeak();
                else {
                    if ("" !== t) {
                        if (e._maxLength > 0) {
                            var i = e[t.toLowerCase()];
                            "string" == typeof i && (t = i)
                        }
                        n.push(t + " "),
                        t = ""
                    }
                    var o = r.mathspeak()
                      , s = r.ctrlSeq;
                    !isNaN(s) || "." === s || r.parent && r.parent.parent && r.parent.parent.isTextBlock() || (o = " " + o + " "),
                    n.push(o)
                }
                return n
            }).join("").replace(/ +(?= )/g, "").replace(/(\.)([0-9]+)/g, function(t, e, n) {
                return e + n.split("").join(" ").trim()
            })
        }
        ,
        n.prototype.keystroke = function(n, r, i) {
            return !i.options.spaceBehavesLikeTab || "Spacebar" !== n && "Shift-Spacebar" !== n ? e.prototype.keystroke.call(this, n, r, i) : (r.preventDefault(),
            void i.escapeDir("Shift-Spacebar" === n ? t : 1, n, r))
        }
        ,
        n.prototype.moveOutOf = function(t, e, n) {
            var r;
            if ("up" === n ? r = this.parent.upInto : "down" === n && (r = this.parent.downInto),
            !r && this[t]) {
                var i = -t;
                e.insAtDirEnd(i, this[t]),
                e.controller.aria.queueDirEndOf(i).queue(e.parent, !0)
            } else
                e.insDirOf(t, this.parent),
                e.controller.aria.queueDirOf(t).queue(this.parent)
        }
        ,
        n.prototype.selectOutOf = function(t, e) {
            e.insDirOf(t, this.parent)
        }
        ,
        n.prototype.deleteOutOf = function(t, e) {
            e.unwrapGramp()
        }
        ,
        n.prototype.seek = function(e, n) {
            var r = this.getEnd(1);
            if (!r || r.jQ.offset().left + r.jQ.outerWidth() < e)
                return n.insAtRightEnd(this);
            if (e < this.getEnd(t).jQ.offset().left)
                return n.insAtLeftEnd(this);
            for (; e < r.jQ.offset().left; )
                r = r[t];
            return r.seek(e, n)
        }
        ,
        n.prototype.chToCmd = function(t, e) {
            var n;
            return t.match(/^[a-eg-zA-Z]$/) ? new ct(t) : /^\d$/.test(t) ? new ot(t) : e && e.typingSlashWritesDivisionSymbol && "/" === t ? g["÷"](t) : e && e.typingAsteriskWritesTimesSymbol && "*" === t ? g["×"](t) : e && e.typingPercentWritesPercentOf && "%" === t ? g.percentof(t) : (n = v[t] || g[t]) ? n.constructor ? new n(t) : n(t) : new X(t)
        }
        ,
        n.prototype.write = function(t, e) {
            var n = this.chToCmd(e, t.options);
            t.selection && n.replaces(t.replaceSelection()),
            t.isTooDeep() || (n.createLeftOf(t.show()),
            "/" === e ? t.controller.aria.alert("over") : t.controller.aria.alert(n.mathspeak({
                createdLeftOf: t
            })))
        }
        ,
        n.prototype.writeLatex = function(e, n) {
            var r = B.all
              , i = B.eof
              , o = $.skip(i).or(r.result(!1)).parse(n);
            if (o && !o.isEmpty() && o.prepareInsertionAt(e)) {
                o.children().adopt(e.parent, e[t], e[1]),
                o.jQize().insertBefore(e.jQ),
                e[t] = o.getEnd(1),
                o.finalizeInsert(e.options, e);
                var s = o.getEnd(1)
                  , a = o.getEnd(t)
                  , c = s[1]
                  , l = a[t];
                c && c.siblingCreated(e.options, t),
                l && l.siblingCreated(e.options, 1),
                e.parent.bubble(function(t) {
                    t.reflow()
                })
            }
        }
        ,
        n.prototype.focus = function() {
            return this.jQ.addClass("dcg-mq-hasCursor"),
            this.jQ.removeClass("dcg-mq-empty"),
            this
        }
        ,
        n.prototype.blur = function(t) {
            return this.jQ.removeClass("dcg-mq-hasCursor"),
            this.isEmpty() && (this.jQ.addClass("dcg-mq-empty"),
            t && this.isQuietEmptyDelimiter(t.options.quietEmptyDelimiters) && this.jQ.addClass("dcg-mq-quiet-delimiter")),
            this
        }
        ,
        n
    }(K);
    S.prototype.mouseEvents = !0,
    k.StaticMath = function(t) {
        var e;
        return (e = function(e) {
            function n(n) {
                var r = e.call(this, n) || this
                  , i = r.innerFields = [];
                return r.__controller.root.postOrder(function(e) {
                    e.registerInnerField(i, t.InnerMathField)
                }),
                r
            }
            return __extends(n, e),
            n.prototype.__mathquillify = function(t, n) {
                return this.config(t),
                e.prototype.__mathquillify.call(this, "dcg-mq-math-mode"),
                this.__options.mouseEvents && (this.__controller.delegateMouseEvents(),
                this.__controller.staticMathTextareaEvents()),
                this
            }
            ,
            n.prototype.latex = function() {
                var n = e.prototype.latex.apply(this, arguments);
                if (arguments.length > 0) {
                    var r = this.innerFields = [];
                    this.__controller.root.postOrder(function(e) {
                        e.registerInnerField(r, t.InnerMathField)
                    }),
                    this.__controller.updateMathspeak()
                }
                return n
            }
            ,
            n.prototype.setAriaLabel = function(t) {
                return this.__controller.setAriaLabel(t),
                this
            }
            ,
            n.prototype.getAriaLabel = function() {
                return this.__controller.getAriaLabel()
            }
            ,
            n
        }(t.AbstractMathQuill)).RootBlock = nt,
        e
    }
    ;
    var rt = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e
    }(nt);
    Q(rt.prototype),
    k.MathField = function(t) {
        var e;
        return (e = function(t) {
            function e() {
                return null !== t && t.apply(this, arguments) || this
            }
            return __extends(e, t),
            e.prototype.__mathquillify = function(e, n) {
                return this.config(e),
                n > 1 && (this.__controller.root.reflow = i),
                t.prototype.__mathquillify.call(this, "dcg-mq-editable-field dcg-mq-math-mode"),
                delete this.__controller.root.reflow,
                this
            }
            ,
            e
        }(t.EditableField)).RootBlock = rt,
        e
    }
    ,
    k.InnerMathField = function(t) {
        return function(t) {
            function e() {
                return null !== t && t.apply(this, arguments) || this
            }
            return __extends(e, t),
            e.prototype.makeStatic = function() {
                this.__controller.editable = !1,
                this.__controller.root.blur(),
                this.__controller.unbindEditablesEvents(),
                this.__controller.container.removeClass("dcg-mq-editable-field")
            }
            ,
            e.prototype.makeEditable = function() {
                this.__controller.editable = !0,
                this.__controller.editablesTextareaEvents(),
                this.__controller.cursor.insAtRightEnd(this.__controller.root),
                this.__controller.container.addClass("dcg-mq-editable-field")
            }
            ,
            e
        }(t.MathField)
    }
    ;
    var it = function(e) {
        function n() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(n, e),
        n.prototype.finalizeTree = function(t, e) {
            this.sharedSiblingMethod(t, e)
        }
        ,
        n.prototype.siblingDeleted = function(t, e) {
            this.sharedSiblingMethod(t, e)
        }
        ,
        n.prototype.siblingCreated = function(t, e) {
            this.sharedSiblingMethod(t, e)
        }
        ,
        n.prototype.sharedSiblingMethod = function(e, r) {
            r !== t && this[1]instanceof n || this.fixDigitGrouping(e)
        }
        ,
        n.prototype.fixDigitGrouping = function(e) {
            if (e.enableDigitGrouping) {
                var n = this
                  , r = this
                  , i = 0
                  , o = []
                  , s = "\\ "
                  , a = n;
                do {
                    if (/^[0-9]$/.test(a.ctrlSeq))
                        n = a;
                    else if (a.ctrlSeq === s)
                        n = a,
                        i += 1;
                    else {
                        if ("." !== a.ctrlSeq)
                            break;
                        n = a,
                        o.push(a)
                    }
                } while (a = n[t]);
                for (; a = r[1]; )
                    if (/^[0-9]$/.test(a.ctrlSeq))
                        r = a;
                    else if (a.ctrlSeq === s)
                        r = a,
                        i += 1;
                    else {
                        if ("." !== a.ctrlSeq)
                            break;
                        r = a,
                        o.push(a)
                    }
                for (; r !== n && n && n.ctrlSeq === s; )
                    n = n[1],
                    i -= 1;
                for (; r !== n && r && r.ctrlSeq === s; )
                    r = r[t],
                    i -= 1;
                if (n !== r || !n || n.ctrlSeq !== s)
                    i > 0 || o.length > 1 ? this.removeGroupingBetween(n, r) : o[0] ? (o[0] !== n && this.addGroupingBetween(o[0][t], n),
                    o[0] !== r && this.removeGroupingBetween(o[0][1], r)) : this.addGroupingBetween(r, n)
            }
        }
        ,
        n.prototype.removeGroupingBetween = function(t, e) {
            var r = t;
            do {
                if (r instanceof n && r.setGroupingClass(void 0),
                !r || r === e)
                    break
            } while (r = r[1])
        }
        ,
        n.prototype.addGroupingBetween = function(e, r) {
            var i = e
              , o = 0
              , s = 0;
            for (i = e; i && (s += 1,
            i !== r); )
                i = i[t];
            var a = s % 3;
            0 === a && (a = 3);
            for (i = e; i; ) {
                o += 1;
                var c = void 0;
                if (s >= 4 && (o === s ? c = "dcg-mq-group-leading-" + a : o % 3 == 0 && o !== s && (c = "dcg-mq-group-start"),
                c || (c = "dcg-mq-group-other")),
                i instanceof n && i.setGroupingClass(c),
                i === r)
                    break;
                i = i[t]
            }
        }
        ,
        n.prototype.setGroupingClass = function(t) {
            this._groupingClass !== t && (this._groupingClass && this.jQ.removeClass(this._groupingClass),
            t && this.jQ.addClass(t),
            this._groupingClass = t)
        }
        ,
        n
    }(Z)
      , ot = function(e) {
        function n(t, n, r) {
            return e.call(this, t, '<span class="dcg-mq-digit">' + (n || t) + "</span>", void 0, r) || this
        }
        return __extends(n, e),
        n.prototype.createLeftOf = function(n) {
            var r = n[t]
              , i = r && r[t]
              , o = n.parent.parent instanceof Dt ? n.parent.parent.sub : void 0;
            n.options.autoSubscriptNumerals && n.parent !== o && (r instanceof st && !1 !== r.isItalic || r instanceof Dt && i instanceof st && !1 !== i.isItalic) ? ((new jt).createLeftOf(n),
            e.prototype.createLeftOf.call(this, n),
            n.insRightOf(n.parent.parent)) : e.prototype.createLeftOf.call(this, n)
        }
        ,
        n.prototype.mathspeak = function(n) {
            if (n && n.createdLeftOf) {
                var r = n.createdLeftOf
                  , i = r[t]
                  , o = i && i[t]
                  , s = r.parent.parent instanceof Dt ? r.parent.parent.sub : void 0;
                if (r.options.autoSubscriptNumerals && r.parent !== s && (i instanceof st && !1 !== i.isItalic || r[t]instanceof Dt && o instanceof st && !1 !== o.isItalic))
                    return "Subscript " + e.prototype.mathspeak.call(this) + " Baseline"
            }
            return e.prototype.mathspeak.call(this)
        }
        ,
        n
    }(it)
      , st = function(e) {
        function n(t, n) {
            return e.call(this, t, "<var>" + (n || t) + "</var>") || this
        }
        return __extends(n, e),
        n.prototype.text = function() {
            var e = this.ctrlSeq || "";
            return this.isPartOfOperator ? "\\" == e[0] ? e = e.slice(1, e.length) : " " == e[e.length - 1] && (e = e.slice(0, -1)) : (!this[t] || this[t]instanceof n || this[t]instanceof tt || "\\ " === this[t].ctrlSeq || (e = "*" + e),
            !this[1] || this[1]instanceof tt || this[1]instanceof Dt || (e += "*")),
            e
        }
        ,
        n.prototype.mathspeak = function() {
            var t = this.ctrlSeq || "";
            return this.isPartOfOperator || t.length > 1 || this.parent && this.parent.parent && this.parent.parent.isTextBlock() ? e.prototype.mathspeak.call(this) : '"' + t + '"'
        }
        ,
        n
    }(Z);
    function at(t, e, n) {
        return function() {
            return new st(t,e)
        }
    }
    S.prototype.autoCommands = {
        _maxLength: 0
    },
    E.autoCommands = function(t) {
        if (!/^[a-z]+(?: [a-z]+)*$/i.test(t))
            throw '"' + t + '" not a space-delimited list of only letters';
        for (var e = t.split(" "), n = {}, i = 0, o = 0; o < e.length; o += 1) {
            var s = e[o];
            if (s.length < 2)
                throw 'autocommand "' + s + '" not minimum length of 2';
            if (g[s] === ht)
                throw '"' + s + '" is a built-in operator name';
            n[s] = 1,
            i = r(i, s.length)
        }
        return n._maxLength = i,
        n
    }
    ,
    S.prototype.quietEmptyDelimiters = {},
    E.quietEmptyDelimiters = function(t) {
        for (var e = t.split(" "), n = {}, r = 0; r < e.length; r += 1) {
            n[e[r]] = 1
        }
        return n
    }
    ,
    S.prototype.autoParenthesizedFunctions = {
        _maxLength: 0
    },
    E.autoParenthesizedFunctions = function(t) {
        if (!/^[a-z]+(?: [a-z]+)*$/i.test(t))
            throw '"' + t + '" not a space-delimited list of only letters';
        for (var e = t.split(" "), n = {}, i = 0, o = 0; o < e.length; o += 1) {
            var s = e[o];
            if (s.length < 2)
                throw 'autocommand "' + s + '" not minimum length of 2';
            n[s] = 1,
            i = r(i, s.length)
        }
        return n._maxLength = i,
        n
    }
    ;
    var ct = function(e) {
        function r(t) {
            var n = e.call(this, t) || this;
            return n.letter = t,
            n
        }
        return __extends(r, e),
        r.prototype.checkAutoCmds = function(e) {
            if (!this.shouldIgnoreSubstitutionInSimpleSubscript(e.options)) {
                var n = e.options.autoCommands
                  , i = n._maxLength || 0;
                if (i > 0) {
                    for (var o = "", s = this, a = 0; s instanceof r && s.ctrlSeq === s.letter && a < i; )
                        o = s.letter + o,
                        s = s[t],
                        a += 1;
                    for (; o.length; ) {
                        if (n.hasOwnProperty(o)) {
                            for (s = this,
                            a = 1; s && a < o.length; a += 1,
                            s = s[t])
                                ;
                            new m(s,this).remove(),
                            e[t] = s[t];
                            var c = g[o];
                            return (y(c) ? new c(o) : c(o)).createLeftOf(e)
                        }
                        o = o.slice(1)
                    }
                }
            }
        }
        ,
        r.prototype.autoParenthesize = function(e) {
            var n = e.parent.getEnd(1);
            if (!(n && n instanceof $t && "\\left(" === n.ctrlSeq || this.shouldIgnoreSubstitutionInSimpleSubscript(e.options))) {
                for (var i = "", o = this, s = 0, a = e.options.autoParenthesizedFunctions, c = a._maxLength || 0, l = e.options.autoOperatorNames; o instanceof r && s < c; )
                    i = o.letter + i,
                    o = o[t],
                    s += 1;
                for (; i.length; ) {
                    if (a.hasOwnProperty(i) && l.hasOwnProperty(i))
                        return e.parent.write(e, "(");
                    i = i.slice(1)
                }
            }
        }
        ,
        r.prototype.createLeftOf = function(t) {
            e.prototype.createLeftOf.call(this, t),
            this.checkAutoCmds(t),
            this.autoParenthesize(t)
        }
        ,
        r.prototype.italicize = function(t) {
            return this.isItalic = t,
            this.isPartOfOperator = !t,
            this.jQ.toggleClass("dcg-mq-operator-name", !t),
            this
        }
        ,
        r.prototype.finalizeTree = function(t, e) {
            this.sharedSiblingMethod(t, e)
        }
        ,
        r.prototype.siblingDeleted = function(t, e) {
            this.sharedSiblingMethod(t, e)
        }
        ,
        r.prototype.siblingCreated = function(t, e) {
            this.sharedSiblingMethod(t, e)
        }
        ,
        r.prototype.sharedSiblingMethod = function(e, n) {
            n !== t && this[1]instanceof r || this.autoUnItalicize(e)
        }
        ,
        r.prototype.autoUnItalicize = function(e) {
            var i = e.autoOperatorNames;
            if (0 !== i._maxLength && !this.shouldIgnoreSubstitutionInSimpleSubscript(e)) {
                for (var o = this.letter, s = this[t]; s instanceof r; s = s[t])
                    o = s.letter + o;
                for (var a = this[1]; a instanceof r; a = a[1])
                    o += a.letter;
                var c = s && s[1]
                  , l = a && a[t];
                new m(c || this.parent.getEnd(t),l || this.parent.getEnd(1)).each(function(t) {
                    t instanceof r && (t.italicize(!0).jQ.removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),
                    t.ctrlSeq = t.letter)
                });
                var p = i._maxLength || 0;
                t: for (var u = 0, h = s[1] || this.parent.getEnd(t); h && u < o.length; u += 1,
                h = h[1])
                    for (var f = n(p, o.length - u); f > 0; f -= 1) {
                        var d = o.slice(u, u + f)
                          , g = void 0;
                        if (i.hasOwnProperty(d)) {
                            for (var v = 0, y = h; v < f; v += 1,
                            y = y[1])
                                y instanceof r && (y.italicize(!1),
                                g = y);
                            var b = lt.hasOwnProperty(d);
                            if (h.ctrlSeq = (b ? "\\" : "\\operatorname{") + h.ctrlSeq,
                            g.ctrlSeq += b ? " " : "}",
                            ut.hasOwnProperty(d)) {
                                var w = g[t]
                                  , q = w && w[t];
                                (q && q[t]).jQ.addClass("dcg-mq-last")
                            }
                            if (this.shouldOmitPadding(h[t]) || h.jQ.addClass("dcg-mq-first"),
                            !this.shouldOmitPadding(g[1]))
                                if (g[1]instanceof Dt) {
                                    var x = g[1];
                                    (x.siblingCreated = x.siblingDeleted = function() {
                                        x.jQ.toggleClass("dcg-mq-after-operator-name", !(x[1]instanceof $t))
                                    }
                                    )()
                                } else
                                    g.jQ.toggleClass("dcg-mq-last", !(g[1]instanceof $t));
                            u += f - 1,
                            h = g;
                            continue t
                        }
                    }
            }
        }
        ,
        r.prototype.shouldOmitPadding = function(t) {
            return !t || ("." === t.ctrlSeq || (t instanceof tt || t instanceof Qt))
        }
        ,
        r
    }(st)
      , lt = {}
      , pt = S.prototype.autoOperatorNames = {
        _maxLength: 9
    }
      , ut = {
        limsup: 1,
        liminf: 1,
        projlim: 1,
        injlim: 1
    };
    !function() {
        for (var t = "arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "), e = 0; e < t.length; e += 1)
            lt[t[e]] = pt[t[e]] = 1;
        var n = "sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" ");
        for (e = 0; e < n.length; e += 1)
            lt[n[e]] = 1;
        var r = "sin cos tan sec cosec csc cotan cot ctg".split(" ");
        for (e = 0; e < r.length; e += 1)
            pt[r[e]] = pt["arc" + r[e]] = pt[r[e] + "h"] = pt["ar" + r[e] + "h"] = pt["arc" + r[e] + "h"] = 1;
        var i = "gcf hcf lcm proj span".split(" ");
        for (e = 0; e < i.length; e += 1)
            pt[i[e]] = 1
    }(),
    E.autoOperatorNames = function(t) {
        if ("string" != typeof t)
            throw '"' + t + '" not a space-delimited list';
        if (!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(t))
            throw '"' + t + '" not a space-delimited list of letters or "|"';
        for (var e = t.split(" "), n = {}, i = 0, o = 0; o < e.length; o += 1) {
            var s = e[o];
            if (s.length < 2)
                throw '"' + s + '" not minimum length of 2';
            if (s.indexOf("|") < 0)
                n[s] = s,
                i = r(i, s.length);
            else {
                var a = s.split("|");
                if (a.length > 2)
                    throw '"' + s + '" has more than 1 mathspeak delimiter';
                if (a[0].length < 2)
                    throw '"' + s[0] + '" not minimum length of 2';
                n[a[0]] = a[1].replace(/-/g, " "),
                i = r(i, a[0].length)
            }
        }
        return n._maxLength = i,
        n
    }
    ;
    var ht = function(t) {
        function e(e) {
            return t.call(this, e || "") || this
        }
        return __extends(e, t),
        e.prototype.createLeftOf = function(t) {
            for (var e = this.ctrlSeq, n = 0; n < e.length; n += 1)
                new ct(e.charAt(n)).createLeftOf(t)
        }
        ,
        e.prototype.parser = function() {
            for (var t = this.ctrlSeq, e = new nt, n = 0; n < t.length; n += 1)
                new ct(t.charAt(n)).adopt(e, e.getEnd(1), 0);
            return B.succeed(e.children())
        }
        ,
        e
    }(Z);
    for (var ft in pt)
        pt.hasOwnProperty(ft) && (g[ft] = ht);
    g.operatorname = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.createLeftOf = function() {}
        ,
        e.prototype.numBlocks = function() {
            return 1
        }
        ,
        e.prototype.parser = function() {
            return $.block.map(function(t) {
                var e = !0
                  , n = ""
                  , r = t.children();
                return r.each(function(t) {
                    t instanceof ct ? n += t.letter : e = !1
                }),
                e && "ans" === n ? Mt() : r
            })
        }
        ,
        e
    }(Y),
    g.f = function(t) {
        function e() {
            var e = this;
            return (e = t.call(this, "f") || this).letter = "f",
            e.htmlTemplate = '<var class="dcg-mq-f">f</var>',
            e
        }
        return __extends(e, t),
        e.prototype.italicize = function(e) {
            return this.jQ.html("f").toggleClass("dcg-mq-f", e),
            t.prototype.italicize.call(this, e)
        }
        ,
        e
    }(ct),
    g[" "] = g.space = function() {
        return new it("\\ ","<span>&nbsp;</span>"," ")
    }
    ,
    g["."] = function() {
        return new it(".",'<span class="dcg-mq-digit">.</span>',".")
    }
    ,
    g["'"] = g.prime = J("'", "&prime;", "prime"),
    g["″"] = g.dprime = J("″", "&Prime;", "double prime"),
    g.backslash = J("\\backslash ", "\\", "backslash"),
    v["\\"] || (v["\\"] = g.backslash),
    g.$ = J("\\$", "$", "dollar"),
    g.square = J("\\square ", "□", "square"),
    g.mid = J("\\mid ", "∣", "mid");
    var dt = function(t) {
        function e(e, n, r) {
            return t.call(this, e, '<span class="dcg-mq-nonSymbola">' + (n || e) + "</span>") || this
        }
        return __extends(e, t),
        e
    }(Z);
    g["@"] = function() {
        return new dt("@")
    }
    ,
    g["&"] = function() {
        return new dt("\\&","&amp;","and")
    }
    ,
    g["%"] = function(t) {
        function e() {
            return t.call(this, "\\%", "%", "percent") || this
        }
        return __extends(e, t),
        e.prototype.parser = function() {
            var e = B.optWhitespace
              , n = B.string;
            return e.then(n("\\operatorname{of}").map(function() {
                return Nt()
            })).or(t.prototype.parser.call(this))
        }
        ,
        e
    }(dt),
    g["∥"] = g.parallel = J("\\parallel ", "&#x2225;", "parallel"),
    g["∦"] = g.nparallel = J("\\nparallel ", "&#x2226;", "not parallel"),
    g["⟂"] = g.perp = J("\\perp ", "&#x27C2;", "perpendicular"),
    g.alpha = g.beta = g.gamma = g.delta = g.zeta = g.eta = g.theta = g.iota = g.kappa = g.mu = g.nu = g.xi = g.rho = g.sigma = g.tau = g.chi = g.psi = g.omega = function(t) {
        return new st("\\" + t + " ","&" + t + ";")
    }
    ,
    g.phi = at("\\phi ", "&#981;"),
    g.phiv = g.varphi = at("\\varphi ", "&phi;"),
    g.epsilon = at("\\epsilon ", "&#1013;"),
    g.epsiv = g.varepsilon = at("\\varepsilon ", "&epsilon;"),
    g.piv = g.varpi = at("\\varpi ", "&piv;"),
    g.sigmaf = g.sigmav = g.varsigma = at("\\varsigma ", "&sigmaf;"),
    g.thetav = g.vartheta = g.thetasym = at("\\vartheta ", "&thetasym;"),
    g.upsilon = g.upsi = at("\\upsilon ", "&upsilon;"),
    g.gammad = g.Gammad = g.digamma = at("\\digamma ", "&#989;"),
    g.kappav = g.varkappa = at("\\varkappa ", "&#1008;"),
    g.rhov = g.varrho = at("\\varrho ", "&#1009;"),
    g.pi = g["π"] = function() {
        return new dt("\\pi ","&pi;","pi")
    }
    ,
    g.lambda = function() {
        return new dt("\\lambda ","&lambda;","lambda")
    }
    ,
    g.Upsilon = g.Upsi = g.upsih = g.Upsih = function() {
        return new Z("\\Upsilon ",'<var style="font-family: serif">&upsih;</var>',"capital upsilon")
    }
    ,
    g.Gamma = g.Delta = g.Theta = g.Lambda = g.Xi = g.Pi = g.Sigma = g.Phi = g.Psi = g.Omega = g.forall = function(t) {
        return new X("\\" + t + " ","&" + t + ";")
    }
    ;
    var mt = function(e) {
        function n(t) {
            var n = e.call(this) || this;
            return n.latexStr = t,
            n
        }
        return __extends(n, e),
        n.prototype.createLeftOf = function(e) {
            var n = $.parse(this.latexStr);
            n.children().adopt(e.parent, e[t], e[1]),
            e[t] = n.getEnd(1),
            n.jQize().insertBefore(e.jQ),
            n.finalizeInsert(e.options, e);
            var r = n.getEnd(1)
              , i = r && r[1];
            i && i.siblingCreated(e.options, t);
            var o = n.getEnd(t)
              , s = o && o[t];
            s && s.siblingCreated(e.options, 1),
            e.parent.bubble(function(t) {
                t.reflow()
            })
        }
        ,
        n.prototype.mathspeak = function() {
            return $.parse(this.latexStr).mathspeak()
        }
        ,
        n.prototype.parser = function() {
            var t = $.parse(this.latexStr).children();
            return B.succeed(t)
        }
        ,
        n
    }(Y);
    function gt(e) {
        if (!e)
            return !1;
        var n = e[t];
        return n ? !(n instanceof tt || /^(\\ )|[,;:\(\[]$/.test(n.ctrlSeq)) : !!(e.parent && e.parent.parent && e.parent.parent.isStyleBlock()) && gt(e.parent.parent)
    }
    g["⁰"] = function() {
        return new mt("^0")
    }
    ,
    g["¹"] = function() {
        return new mt("^1")
    }
    ,
    g["²"] = function() {
        return new mt("^2")
    }
    ,
    g["³"] = function() {
        return new mt("^3")
    }
    ,
    g["⁴"] = function() {
        return new mt("^4")
    }
    ,
    g["⁵"] = function() {
        return new mt("^5")
    }
    ,
    g["⁶"] = function() {
        return new mt("^6")
    }
    ,
    g["⁷"] = function() {
        return new mt("^7")
    }
    ,
    g["⁸"] = function() {
        return new mt("^8")
    }
    ,
    g["⁹"] = function() {
        return new mt("^9")
    }
    ,
    g["¼"] = function() {
        return new mt("\\frac14")
    }
    ,
    g["½"] = function() {
        return new mt("\\frac12")
    }
    ,
    g["¾"] = function() {
        return new mt("\\frac34")
    }
    ,
    g["√"] = function() {
        return new mt("\\sqrt{}")
    }
    ;
    var vt = function(t) {
        function e(e, n, r) {
            return t.call(this, e, n, void 0, r, !0) || this
        }
        return __extends(e, t),
        e.prototype.contactWeld = function(t, e) {
            this.sharedSiblingMethod(t.options, e)
        }
        ,
        e.prototype.siblingCreated = function(t, e) {
            this.sharedSiblingMethod(t, e)
        }
        ,
        e.prototype.siblingDeleted = function(t, e) {
            this.sharedSiblingMethod(t, e)
        }
        ,
        e.prototype.sharedSiblingMethod = function(t, e) {
            if (1 !== e)
                return this.jQ[0].className = gt(this) ? "dcg-mq-binary-operator" : "",
                this
        }
        ,
        e
    }(tt);
    g["+"] = function(t) {
        function e() {
            return t.call(this, "+", "+") || this
        }
        return __extends(e, t),
        e.prototype.mathspeak = function() {
            return gt(this) ? "plus" : "positive"
        }
        ,
        e
    }(vt);
    var yt = function(t) {
        function e() {
            return t.call(this, "-", "&minus;") || this
        }
        return __extends(e, t),
        e.prototype.mathspeak = function() {
            return gt(this) ? "minus" : "negative"
        }
        ,
        e
    }(vt);
    g["−"] = g["—"] = g["–"] = g["-"] = yt,
    g["±"] = g.pm = g.plusmn = g.plusminus = function() {
        return new vt("\\pm ","&plusmn;","plus-or-minus")
    }
    ,
    g.mp = g.mnplus = g.minusplus = function() {
        return new vt("\\mp ","&#8723;","minus-or-plus")
    }
    ,
    v["*"] = g.sdot = g.cdot = et("\\cdot ", "&middot;", "*", "times");
    var bt = function(e) {
        function n() {
            return e.call(this, "\\to ", "&rarr;", "to") || this
        }
        return __extends(n, e),
        n.prototype.deleteTowards = function(n, r) {
            if (n === t) {
                var i = r[t];
                return new m(i,this).remove(),
                r[t] = i[t],
                (new yt).createLeftOf(r),
                void r[t].bubble(function(t) {
                    t.reflow()
                })
            }
            e.prototype.deleteTowards.call(this, n, r)
        }
        ,
        n
    }(tt);
    g["→"] = g.to = bt;
    var wt = function(e) {
        function n(t, n) {
            var r = this
              , i = n ? "Strict" : "";
            return (r = e.call(this, t["ctrlSeq".concat(i)], t["html".concat(i)], t["text".concat(i)], t["mathspeak".concat(i)]) || this).data = t,
            r.strict = n,
            r
        }
        return __extends(n, e),
        n.prototype.swap = function(t) {
            this.strict = t;
            var e = t ? "Strict" : "";
            this.ctrlSeq = this.data["ctrlSeq".concat(e)],
            this.jQ.html(this.data["html".concat(e)]),
            this.textTemplate = [this.data["text".concat(e)]],
            this.mathspeakName = this.data["mathspeak".concat(e)]
        }
        ,
        n.prototype.deleteTowards = function(n, r) {
            if (n === t && !this.strict)
                return this.swap(!0),
                void this.bubble(function(t) {
                    t.reflow()
                });
            e.prototype.deleteTowards.call(this, n, r)
        }
        ,
        n
    }(tt)
      , qt = {
        ctrlSeq: "\\le ",
        html: "&le;",
        text: "≤",
        mathspeak: "less than or equal to",
        ctrlSeqStrict: "<",
        htmlStrict: "&lt;",
        textStrict: "<",
        mathspeakStrict: "less than"
    }
      , xt = {
        ctrlSeq: "\\ge ",
        html: "&ge;",
        text: "≥",
        mathspeak: "greater than or equal to",
        ctrlSeqStrict: ">",
        htmlStrict: "&gt;",
        textStrict: ">",
        mathspeakStrict: "greater than"
    }
      , kt = function(e) {
        function n() {
            return e.call(this, xt, !0) || this
        }
        return __extends(n, e),
        n.prototype.createLeftOf = function(n) {
            var r = n[t];
            if (r instanceof tt && "-" === r.ctrlSeq) {
                var i = r;
                return n[t] = i[t],
                i.remove(),
                (new bt).createLeftOf(n),
                void n[t].bubble(function(t) {
                    t.reflow()
                })
            }
            e.prototype.createLeftOf.call(this, n)
        }
        ,
        n
    }(wt);
    g["<"] = g.lt = function() {
        return new wt(qt,!0)
    }
    ,
    g[">"] = g.gt = kt,
    g["≤"] = g.le = g.leq = function() {
        return new wt(qt,!1)
    }
    ,
    g["≥"] = g.ge = g.geq = function() {
        return new wt(xt,!1)
    }
    ,
    g.infty = g.infin = g.infinity = J("\\infty ", "&infin;", "infinity"),
    g["≠"] = g.ne = g.neq = et("\\ne ", "&ne;", "not equal");
    var _t = function(e) {
        function n() {
            return e.call(this, "=", "=", "=", "equals") || this
        }
        return __extends(n, e),
        n.prototype.createLeftOf = function(n) {
            var r = n[t];
            if (r instanceof wt && r.strict)
                return r.swap(!1),
                void r.bubble(function(t) {
                    t.reflow()
                });
            e.prototype.createLeftOf.call(this, n)
        }
        ,
        n
    }(tt);
    g["="] = _t,
    g["×"] = g.times = et("\\times ", "&times;", "[x]", "times"),
    g["÷"] = g.div = g.divide = g.divides = et("\\div ", "&divide;", "[/]", "over");
    var Et = function(e) {
        function n() {
            return e.call(this, "\\sim ", "~", "~", "tilde") || this
        }
        return __extends(n, e),
        n.prototype.createLeftOf = function(r) {
            if (r[t]instanceof n) {
                var i = r[t];
                return r[t] = i[t],
                i.remove(),
                (new St).createLeftOf(r),
                void r[t].bubble(function(t) {
                    t.reflow()
                })
            }
            e.prototype.createLeftOf.call(this, r)
        }
        ,
        n
    }(tt)
      , St = function(e) {
        function n() {
            return e.call(this, "\\approx ", "&approx;", "≈", "approximately equal") || this
        }
        return __extends(n, e),
        n.prototype.deleteTowards = function(n, r) {
            if (n === t) {
                var i = r[t];
                return new m(i,this).remove(),
                r[t] = i[t],
                (new Et).createLeftOf(r),
                void r[t].bubble(function(t) {
                    t.reflow()
                })
            }
            e.prototype.deleteTowards.call(this, n, r)
        }
        ,
        n
    }(tt);
    v["~"] = g.sim = Et,
    g["≈"] = g.approx = St;
    var Ot = {
        sqrt: {
            width: "",
            html: '<svg preserveAspectRatio="none" viewBox="0 0 32 54"><path d="M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33" /></svg>'
        },
        "|": {
            width: ".4em",
            html: '<svg preserveAspectRatio="none" viewBox="0 0 10 54"><path d="M4.4 0 L4.4 54 L5.6 54 L5.6 0" /></svg>'
        },
        "[": {
            width: ".55em",
            html: '<svg preserveAspectRatio="none" viewBox="0 0 11 24"><path d="M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1" /></svg>'
        },
        "]": {
            width: ".55em",
            html: '<svg preserveAspectRatio="none" viewBox="0 0 11 24"><path d="M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1" /></svg>'
        },
        "(": {
            width: ".55em",
            html: '<svg preserveAspectRatio="none" viewBox="3 0 106 186"><path d="M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0" /></svg>'
        },
        ")": {
            width: ".55em",
            html: '<svg preserveAspectRatio="none" viewBox="3 0 106 186"><path d="M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0" /></svg>'
        },
        "{": {
            width: ".7em",
            html: '<svg preserveAspectRatio="none" viewBox="10 0 210 350"><path d="M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0" /></svg>'
        },
        "}": {
            width: ".7em",
            html: '<svg preserveAspectRatio="none" viewBox="10 0 210 350"><path d="M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0" /></svg>'
        },
        "&#8741;": {
            width: ".7em",
            html: '<svg preserveAspectRatio="none" viewBox="0 0 10 54"><path d="M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0" /></svg>'
        },
        "&lang;": {
            width: ".55em",
            html: '<svg preserveAspectRatio="none" viewBox="0 0 10 54"><path d="M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0" /></svg>'
        },
        "&rang;": {
            width: ".55em",
            html: '<svg preserveAspectRatio="none" viewBox="0 0 10 54"><path d="M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0" /></svg>'
        }
    }
      , Lt = function(t) {
        function e(e, n, r, i, o) {
            var s = t.call(this, e, "<" + n + " " + r + ">&0</" + n + ">") || this;
            return s.ariaLabel = i || e.replace(/^\\/, ""),
            s.mathspeakTemplate = ["Start" + s.ariaLabel + ",", "End" + s.ariaLabel],
            s.shouldNotSpeakDelimiters = o && o.shouldNotSpeakDelimiters,
            s
        }
        return __extends(e, t),
        e.prototype.mathspeak = function(e) {
            return !this.shouldNotSpeakDelimiters || e && e.ignoreShorthand ? t.prototype.mathspeak.call(this) : this.foldChildren("", function(t, n) {
                return t + " " + n.mathspeak(e)
            }).trim()
        }
        ,
        e
    }(Y);
    g.mathrm = function(t) {
        function e() {
            return t.call(this, "\\mathrm", "span", 'class="dcg-mq-roman dcg-mq-font"', "Roman Font", {
                shouldNotSpeakDelimiters: !0
            }) || this
        }
        return __extends(e, t),
        e.prototype.isTextBlock = function() {
            return !0
        }
        ,
        e
    }(Lt),
    g.mathit = function() {
        return new Lt("\\mathit","i",'class="dcg-mq-font"',"Italic Font")
    }
    ,
    g.mathbf = function() {
        return new Lt("\\mathbf","b",'class="dcg-mq-font"',"Bold Font")
    }
    ,
    g.mathsf = function() {
        return new Lt("\\mathsf","span",'class="dcg-mq-sans-serif dcg-mq-font"',"Serif Font")
    }
    ,
    g.mathtt = function() {
        return new Lt("\\mathtt","span",'class="dcg-mq-monospace dcg-mq-font"',"Math Text")
    }
    ,
    g.underline = function() {
        return new Lt("\\underline","span",'class="dcg-mq-non-leaf dcg-mq-underline"',"Underline")
    }
    ,
    g.overline = g.bar = function() {
        return new Lt("\\overline","span",'class="dcg-mq-non-leaf dcg-mq-overline"',"Overline")
    }
    ,
    g.overrightarrow = function() {
        return new Lt("\\overrightarrow","span",'class="dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-right"',"Over Right Arrow")
    }
    ,
    g.overleftarrow = function() {
        return new Lt("\\overleftarrow","span",'class="dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-left"',"Over Left Arrow")
    }
    ,
    g.overleftrightarrow = function() {
        return new Lt("\\overleftrightarrow ","span",'class="dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-leftright"',"Over Left and Right Arrow")
    }
    ,
    g.overarc = function() {
        return new Lt("\\overarc","span",'class="dcg-mq-non-leaf dcg-mq-overarc"',"Over Arc")
    }
    ,
    g.dot = function() {
        return new Y("\\dot",'<span class="dcg-mq-non-leaf"><span class="dcg-mq-dot-recurring-inner"><span class="dcg-mq-dot-recurring">&#x2d9;</span><span class="dcg-mq-empty-box">&0</span></span></span>')
    }
    ,
    g.textcolor = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.setColor = function(t) {
            this.color = t,
            this.htmlTemplate = '<span class="dcg-mq-textcolor" style="color:' + t + '">&0</span>',
            this.ariaLabel = t.replace(/^\\/, ""),
            this.mathspeakTemplate = ["Start " + this.ariaLabel + ",", "End " + this.ariaLabel]
        }
        ,
        e.prototype.latex = function() {
            var t = this.blocks[0];
            return "\\textcolor{" + this.color + "}{" + t.latex() + "}"
        }
        ,
        e.prototype.parser = function() {
            var e = this
              , n = B.optWhitespace
              , r = B.string
              , i = B.regex;
            return n.then(r("{")).then(i(/^[#\w\s.,()%-]*/)).skip(r("}")).then(function(n) {
                return e.setColor(n),
                t.prototype.parser.call(e)
            })
        }
        ,
        e.prototype.isStyleBlock = function() {
            return !0
        }
        ,
        e
    }(Y);
    g.class = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.parser = function() {
            var e = this
              , n = B.string
              , r = B.regex;
            return B.optWhitespace.then(n("{")).then(r(/^[-\w\s\\\xA0-\xFF]*/)).skip(n("}")).then(function(n) {
                return e.cls = n || "",
                e.htmlTemplate = '<span class="dcg-mq-class ' + n + '">&0</span>',
                e.ariaLabel = n + " class",
                e.mathspeakTemplate = ["Start " + e.ariaLabel + ",", "End " + e.ariaLabel],
                t.prototype.parser.call(e)
            })
        }
        ,
        e.prototype.latex = function() {
            var t = this.blocks[0];
            return "\\class{" + this.cls + "}{" + t.latex() + "}"
        }
        ,
        e.prototype.isStyleBlock = function() {
            return !0
        }
        ,
        e
    }(Y);
    var Tt = /^[\+\-]?[\d]+$/;
    function Ct(e) {
        if (!e)
            return "";
        var n = e.children();
        if (!n || !n.getEnd(t))
            return "";
        for (var r = "", i = n.getEnd(t); i && void 0 !== i[1]; i = i[1])
            void 0 !== i.ctrlSeq && (r += i.ctrlSeq);
        return r
    }
    S.prototype.charsThatBreakOutOfSupSub = "";
    var Dt = function(e) {
        function n() {
            var t = null !== e && e.apply(this, arguments) || this;
            return t.ctrlSeq = "_{...}^{...}",
            t
        }
        return __extends(n, e),
        n.prototype.setEnds = function(e) {
            o("SupSub ends must be MathBlocks", e[t]instanceof nt && e[1]instanceof nt),
            this.ends = e
        }
        ,
        n.prototype.getEnd = function(t) {
            return this.ends[t]
        }
        ,
        n.prototype.createLeftOf = function(n) {
            if (this.replacedFragment || n[t] || !n.options.supSubsRequireOperand)
                return e.prototype.createLeftOf.call(this, n)
        }
        ,
        n.prototype.contactWeld = function(e) {
            for (var r = t; r; r = r === t && 1) {
                var i = this[r]
                  , o = void 0;
                if (i instanceof n) {
                    for (var s = "sub"; s; s = "sub" === s && "sup") {
                        var a = this[s]
                          , c = i[s];
                        if (a) {
                            if (c)
                                if (a.isEmpty())
                                    o = new l(c,0,c.getEnd(t));
                                else {
                                    a.jQ.children().insAtDirEnd(-r, c.jQ);
                                    var p = a.children().disown();
                                    o = new l(c,p.getEnd(1),c.getEnd(t)),
                                    r === t ? p.adopt(c, c.getEnd(1), 0) : p.adopt(c, 0, c.getEnd(t))
                                }
                            else
                                i.addBlock(a.disown());
                            this.placeCursor = function(t, e) {
                                return function(n) {
                                    n.insAtDirEnd(-r, t || e)
                                }
                            }(c, a)
                        }
                    }
                    this.remove(),
                    e && e[t] === this && (1 === r && o ? o[t] ? e.insRightOf(o[t]) : e.insAtLeftEnd(o.parent) : e.insRightOf(i));
                    break
                }
            }
        }
        ,
        n.prototype.finalizeTree = function() {
            this.getEnd(t).write = function(e, n) {
                if (e.options.autoSubscriptNumerals && this === this.parent.sub) {
                    if ("_" === n)
                        return;
                    var r = this.chToCmd(n, e.options);
                    return r instanceof Z ? e.deleteSelection() : e.clearSelection().insRightOf(this.parent),
                    r.createLeftOf(e.show()),
                    void e.controller.aria.queue("Baseline").alert(r.mathspeak({
                        createdLeftOf: e
                    }))
                }
                e[t] && !e[1] && !e.selection && e.options.charsThatBreakOutOfSupSub.indexOf(n) > -1 && (e.insRightOf(this.parent),
                e.controller.aria.queue("Baseline")),
                nt.prototype.write.call(this, e, n)
            }
        }
        ,
        n.prototype.moveTowards = function(t, n, r) {
            n.options.autoSubscriptNumerals && !this.sup ? n.insDirOf(t, this) : e.prototype.moveTowards.call(this, t, n, r)
        }
        ,
        n.prototype.deleteTowards = function(n, r) {
            if (r.options.autoSubscriptNumerals && this.sub) {
                var i = this.sub.getEnd(-n);
                i instanceof Z ? i.remove() : i && i.deleteTowards(n, r.insAtDirEnd(-n, this.sub)),
                this.sub.isEmpty() && (this.sub.deleteOutOf(t, r.insAtLeftEnd(this.sub)),
                this.sup && r.insDirOf(-n, this))
            } else
                e.prototype.deleteTowards.call(this, n, r)
        }
        ,
        n.prototype.latex = function() {
            function t(t, e) {
                var n = e && e.latex();
                return e ? t + "{" + (n || " ") + "}" : ""
            }
            return t("_", this.sub) + t("^", this.sup)
        }
        ,
        n.prototype.text = function() {
            function t(t, e) {
                var n = e && e.text() || "";
                return e ? t + (1 === n.length ? n : "(" + (n || " ") + ")") : ""
            }
            return t("_", this.sub) + t("^", this.sup)
        }
        ,
        n.prototype.addBlock = function(t) {
            "sub" === this.supsub ? (this.sup = this.upInto = this.sub.upOutOf = t,
            t.adopt(this, this.sub, 0).downOutOf = this.sub,
            t.jQ = c('<span class="dcg-mq-sup"/>').append(t.jQ.children()).prependTo(this.jQ),
            f.linkElementByBlockNode(t.jQ[0], t)) : (this.sub = this.downInto = this.sup.downOutOf = t,
            t.adopt(this, 0, this.sup).upOutOf = this.sup,
            t.jQ = c('<span class="dcg-mq-sub"></span>').append(t.jQ.children()).appendTo(this.jQ.removeClass("dcg-mq-sup-only")),
            f.linkElementByBlockNode(t.jQ[0], t),
            this.jQ.append('<span style="display:inline-block;width:0">&#8203;</span>'));
            for (var e = 0; e < 2; e += 1)
                !function(t, e, n, r) {
                    t[e].deleteOutOf = function(i, o) {
                        if (o.insDirOf(this[i] ? -i : i, this.parent),
                        !this.isEmpty()) {
                            var s = this.getEnd(i);
                            this.children().disown().withDirAdopt(i, o.parent, o[i], o[-i]).jQ.insDirOf(-i, o.jQ),
                            o[-i] = s
                        }
                        t.supsub = n,
                        delete t[e],
                        delete t["".concat(r, "Into")];
                        var a = t[n];
                        a["".concat(r, "OutOf")] = At,
                        delete a.deleteOutOf,
                        "sub" === e && c(t.jQ.addClass("dcg-mq-sup-only")[0].lastChild).remove(),
                        this.remove()
                    }
                }(this, "sub sup".split(" ")[e], "sup sub".split(" ")[e], "down up".split(" ")[e])
        }
        ,
        n
    }(Y);
    function At(t) {
        var e = this.parent
          , n = t;
        do {
            if (n[1])
                return t.insLeftOf(e);
            n = n.parent.parent
        } while (n !== e);
        t.insRightOf(e)
    }
    var jt = function(e) {
        function n() {
            var t = null !== e && e.apply(this, arguments) || this;
            return t.supsub = "sub",
            t.htmlTemplate = '<span class="dcg-mq-supsub dcg-mq-non-leaf"><span class="dcg-mq-sub">&0</span><span style="display:inline-block;width:0">&#8203;</span></span>',
            t.textTemplate = ["_"],
            t.mathspeakTemplate = ["Subscript,", ", Baseline"],
            t.ariaLabel = "subscript",
            t
        }
        return __extends(n, e),
        n.prototype.finalizeTree = function() {
            this.downInto = this.sub = this.getEnd(t),
            this.sub.upOutOf = At,
            e.prototype.finalizeTree.call(this)
        }
        ,
        n
    }(Dt);
    g.subscript = g._ = jt,
    g.superscript = g.supscript = g["^"] = function(t) {
        function e() {
            var e = null !== t && t.apply(this, arguments) || this;
            return e.supsub = "sup",
            e.htmlTemplate = '<span class="dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"><span class="dcg-mq-sup">&0</span></span>',
            e.textTemplate = ["^(", ")"],
            e.ariaLabel = "superscript",
            e.mathspeakTemplate = ["Superscript,", ", Baseline"],
            e
        }
        return __extends(e, t),
        e.prototype.mathspeak = function(e) {
            var n = this.upInto;
            if (void 0 !== n) {
                var r = Ct(n);
                if ((!e || !e.ignoreShorthand) && Tt.test(r)) {
                    if ("0" === r)
                        return "to the 0 power";
                    if ("2" === r)
                        return "squared";
                    if ("3" === r)
                        return "cubed";
                    var i = "";
                    return /^[+-]?\d{1,3}$/.test(r) && (/(11|12|13|4|5|6|7|8|9|0)$/.test(r) ? i = "th" : /1$/.test(r) ? i = "st" : /2$/.test(r) ? i = "nd" : /3$/.test(r) && (i = "rd")),
                    "to the " + ("object" == typeof n ? n.mathspeak() : r) + i + " power"
                }
            }
            return t.prototype.mathspeak.call(this)
        }
        ,
        e.prototype.finalizeTree = function() {
            this.upInto = this.sup = this.getEnd(1),
            this.sup.downOutOf = At,
            t.prototype.finalizeTree.call(this)
        }
        ,
        e
    }(Dt);
    var Qt = function(e) {
        function n(t, n, r) {
            var i = e.call(this) || this;
            i.ariaLabel = r || t.replace(/^\\/, "");
            var o = '<span class="dcg-mq-large-operator dcg-mq-non-leaf"><span class="dcg-mq-to"><span>&1</span></span><big>' + n + '</big><span class="dcg-mq-from"><span>&0</span></span></span>';
            return Z.prototype.setCtrlSeqHtmlTextAndMathspeak.call(i, t, o),
            i
        }
        return __extends(n, e),
        n.prototype.createLeftOf = function(t) {
            e.prototype.createLeftOf.call(this, t),
            t.options.sumStartsWithNEquals && (new ct("n").createLeftOf(t),
            (new _t).createLeftOf(t))
        }
        ,
        n.prototype.latex = function() {
            function e(t) {
                return "{" + (t || " ") + "}"
            }
            return this.ctrlSeq + "_" + e(this.getEnd(t).latex()) + "^" + e(this.getEnd(1).latex())
        }
        ,
        n.prototype.mathspeak = function() {
            return "Start " + this.ariaLabel + " from " + this.getEnd(t).mathspeak() + " to " + this.getEnd(1).mathspeak() + ", end " + this.ariaLabel + ", "
        }
        ,
        n.prototype.parser = function() {
            for (var t = B.string, e = B.optWhitespace, n = B.succeed, r = $.block, i = this, o = i.blocks = [new nt, new nt], s = 0; s < o.length; s += 1)
                o[s].adopt(i, i.getEnd(1), 0);
            return e.then(t("_").or(t("^"))).then(function(t) {
                var e = o["_" === t ? 0 : 1];
                return r.then(function(t) {
                    return t.children().adopt(e, e.getEnd(1), 0),
                    n(i)
                })
            }).many().result(i)
        }
        ,
        n.prototype.finalizeTree = function() {
            var e = this.getEnd(t)
              , n = this.getEnd(1);
            e.ariaLabel = "lower bound",
            n.ariaLabel = "upper bound",
            this.downInto = e,
            this.upInto = n,
            e.upOutOf = n,
            n.downOutOf = e
        }
        ,
        n
    }(Y);
    g["∑"] = g.sum = g.summation = function() {
        return new Qt("\\sum ","&sum;","sum")
    }
    ,
    g["∏"] = g.prod = g.product = function() {
        return new Qt("\\prod ","&prod;","product")
    }
    ,
    g.coprod = g.coproduct = function() {
        return new Qt("\\coprod ","&#8720;","co product")
    }
    ,
    g["∫"] = g.int = g.integral = function(t) {
        function e() {
            var e = this;
            return (e = t.call(this, "\\int ", "", "integral") || this).ariaLabel = "integral",
            e.htmlTemplate = '<span class="dcg-mq-int dcg-mq-non-leaf"><big>&int;</big><span class="dcg-mq-supsub dcg-mq-non-leaf"><span class="dcg-mq-sup"><span class="dcg-mq-sup-inner">&1</span></span><span class="dcg-mq-sub">&0</span><span style="display:inline-block;width:0">&#8203</span></span></span>',
            e
        }
        return __extends(e, t),
        e.prototype.createLeftOf = function(t) {
            Y.prototype.createLeftOf.call(this, t)
        }
        ,
        e
    }(Qt);
    var It = g.frac = g.dfrac = g.cfrac = g.fraction = function(e) {
        function n() {
            var t = null !== e && e.apply(this, arguments) || this;
            return t.ctrlSeq = "\\frac",
            t.htmlTemplate = '<span class="dcg-mq-fraction dcg-mq-non-leaf"><span class="dcg-mq-numerator">&0</span><span class="dcg-mq-denominator">&1</span><span style="display:inline-block;width:0">&#8203;</span></span>',
            t.textTemplate = ["(", ")/(", ")"],
            t
        }
        return __extends(n, e),
        n.prototype.finalizeTree = function() {
            var e = this.getEnd(t)
              , n = this.getEnd(1);
            this.upInto = n.upOutOf = e,
            this.downInto = e.downOutOf = n,
            e.ariaLabel = "numerator",
            n.ariaLabel = "denominator",
            this.getFracDepth() > 1 ? this.mathspeakTemplate = ["StartNestedFraction,", "NestedOver", ", EndNestedFraction"] : this.mathspeakTemplate = ["StartFraction,", "Over", ", EndFraction"]
        }
        ,
        n.prototype.mathspeak = function(n) {
            if (n && n.createdLeftOf)
                return n.createdLeftOf.parent.mathspeak();
            var r = Ct(this.getEnd(t))
              , i = Ct(this.getEnd(1));
            if ((!n || !n.ignoreShorthand) && Tt.test(r) && Tt.test(i)) {
                var o = "1" === r || "-1" === r
                  , s = "";
                if ("2" === i ? s = o ? "half" : "halves" : "3" === i ? s = o ? "third" : "thirds" : "4" === i ? s = o ? "quarter" : "quarters" : "5" === i ? s = o ? "fifth" : "fifths" : "6" === i ? s = o ? "sixth" : "sixths" : "7" === i ? s = o ? "seventh" : "sevenths" : "8" === i ? s = o ? "eighth" : "eighths" : "9" === i && (s = o ? "ninth" : "ninths"),
                "" !== s) {
                    for (var a = "", c = !1, l = this[t]; l && void 0 !== l[t]; l = l[t])
                        if ("\\ " !== l.ctrlSeq) {
                            if (!Tt.test(l.ctrlSeq || "")) {
                                c = !1;
                                break
                            }
                            c = !0
                        }
                    return c && (a += "and "),
                    a += this.getEnd(t).mathspeak() + " " + s
                }
            }
            return e.prototype.mathspeak.call(this)
        }
        ,
        n.prototype.getFracDepth = function() {
            var t = function(e, n) {
                return e instanceof F && e.ctrlSeq && e.ctrlSeq.toLowerCase().search("frac") >= 0 && (n += 1),
                e && e.parent ? t(e.parent, n) : n
            };
            return t(this, 0)
        }
        ,
        n
    }(Y)
      , Bt = g.over = v["/"] = function(e) {
        function n() {
            return null !== e && e.apply(this, arguments) || this
        }
        return __extends(n, e),
        n.prototype.createLeftOf = function(n) {
            if (!this.replacedFragment) {
                var r = n[t];
                if (!n.options.typingSlashCreatesNewFraction)
                    for (; r && !(r instanceof tt || r instanceof (g.text || i) || r instanceof Qt || "\\ " === r.ctrlSeq || /^[,;:]$/.test(r.ctrlSeq)); )
                        r = r[t];
                if (r instanceof Qt && r[1]instanceof Dt)
                    (o = (r = r[1])[1])instanceof Dt && o.ctrlSeq != r.ctrlSeq && (r = r[1]);
                if (r !== n[t] && !n.isTooDeep(1)) {
                    var o = r[1]
                      , s = n[t];
                    this.replaces(new m(o || n.parent.getEnd(t),s)),
                    n[t] = r
                }
            }
            e.prototype.createLeftOf.call(this, n)
        }
        ,
        n
    }(It)
      , Mt = function() {
        return new Z("\\operatorname{ans}",'<span class="dcg-mq-ans">ans</span>',"ans")
    };
    g.ans = Mt;
    var Nt = function() {
        return new Z("\\%\\operatorname{of}",'<span class="dcg-mq-nonSymbola dcg-mq-operator-name">% of </span>',"percent of")
    };
    g.percent = g.percentof = Nt;
    var Rt = function(t) {
        function e() {
            var e = null !== t && t.apply(this, arguments) || this;
            return e.ctrlSeq = "\\sqrt",
            e.htmlTemplate = '<span class="dcg-mq-non-leaf dcg-mq-sqrt-container"><span class="dcg-mq-scaled dcg-mq-sqrt-prefix">' + Ot.sqrt.html + '</span><span class="dcg-mq-non-leaf dcg-mq-sqrt-stem">&0</span></span>',
            e.textTemplate = ["sqrt(", ")"],
            e.mathspeakTemplate = ["StartRoot,", ", EndRoot"],
            e.ariaLabel = "root",
            e
        }
        return __extends(e, t),
        e.prototype.parser = function() {
            return $.optBlock.then(function(t) {
                return $.block.map(function(e) {
                    var n = new zt;
                    return n.blocks = [t, e],
                    t.adopt(n, 0, 0),
                    e.adopt(n, t, 0),
                    n
                })
            }).or(t.prototype.parser.call(this))
        }
        ,
        e
    }(Y);
    g.sqrt = Rt,
    g.hat = function(t) {
        function e() {
            var e = null !== t && t.apply(this, arguments) || this;
            return e.ctrlSeq = "\\hat",
            e.htmlTemplate = '<span class="dcg-mq-non-leaf"><span class="dcg-mq-hat-prefix">^</span><span class="dcg-mq-hat-stem">&0</span></span>',
            e.textTemplate = ["hat(", ")"],
            e
        }
        return __extends(e, t),
        e
    }(Y);
    var zt = function(e) {
        function n() {
            var t = null !== e && e.apply(this, arguments) || this;
            return t.htmlTemplate = '<span class="dcg-mq-nthroot-container dcg-mq-non-leaf"><sup class="dcg-mq-nthroot dcg-mq-non-leaf">&0</sup><span class="dcg-mq-scaled dcg-mq-sqrt-container"><span class="dcg-mq-sqrt-prefix dcg-mq-scaled">' + Ot.sqrt.html + '</span><span class="dcg-mq-sqrt-stem dcg-mq-non-leaf">&1</span></span></span>',
            t.textTemplate = ["sqrt[", "](", ")"],
            t
        }
        return __extends(n, e),
        n.prototype.latex = function() {
            return "\\sqrt[" + this.getEnd(t).latex() + "]{" + this.getEnd(1).latex() + "}"
        }
        ,
        n.prototype.mathspeak = function() {
            var e = this.getEnd(t).mathspeak()
              , n = this.getEnd(1).mathspeak();
            return this.getEnd(t).ariaLabel = "Index",
            this.getEnd(1).ariaLabel = "Radicand",
            "3" === e ? "Start Cube Root, " + n + ", End Cube Root" : "Root Index " + e + ", Start Root, " + n + ", End Root"
        }
        ,
        n
    }(Rt);
    g.nthroot = zt,
    g.cbrt = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.createLeftOf = function(e) {
            t.prototype.createLeftOf.call(this, e),
            new ot("3").createLeftOf(e),
            e.controller.moveRight()
        }
        ,
        e
    }(zt);
    var Ft = function(t) {
        function e(e, n, r) {
            var i = '<span class="dcg-mq-non-leaf"><span class="dcg-mq-diacritic-above">' + n + '</span><span class="dcg-mq-diacritic-stem">&0</span></span>';
            return t.call(this, e, i, r) || this
        }
        return __extends(e, t),
        e
    }(Y);
    g.vec = function() {
        return new Ft("\\vec","&rarr;",["vec(", ")"])
    }
    ,
    g.tilde = function() {
        return new Ft("\\tilde","~",["tilde(", ")"])
    }
    ;
    var Pt = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.jQadd = function(e) {
            return t.prototype.jQadd.call(this, e),
            this.delimjQs = this.jQ.children(":first").add(this.jQ.children(":last")),
            this.contentjQ = this.jQ.children(":eq(1)"),
            this.jQ
        }
        ,
        e
    }(Y)
      , $t = function(e) {
        function n(n, r, i, o, s) {
            var a, c = e.call(this, "\\left" + o, void 0, [r, i]) || this;
            return c.side = n,
            c.sides = ((a = {})[t] = {
                ch: r,
                ctrlSeq: o
            },
            a[1] = {
                ch: i,
                ctrlSeq: s
            },
            a),
            c
        }
        return __extends(n, e),
        n.prototype.numBlocks = function() {
            return 1
        }
        ,
        n.prototype.html = function() {
            var n = this.getSymbol(t)
              , r = this.getSymbol(1);
            return this.htmlTemplate = '<span class="dcg-mq-non-leaf dcg-mq-bracket-container"><span style="width:' + n.width + '" class="dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren' + (1 === this.side ? " dcg-mq-ghost" : "") + '">' + n.html + '</span><span style="margin-left:' + n.width + ";margin-right:" + r.width + '" class="dcg-mq-bracket-middle dcg-mq-non-leaf">&0</span><span style="width:' + r.width + '" class="dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren' + (this.side === t ? " dcg-mq-ghost" : "") + '">' + r.html + "</span></span>",
            e.prototype.html.call(this)
        }
        ,
        n.prototype.getSymbol = function(t) {
            var e = this.sides[t || 1].ch;
            return Ot[e] || {
                width: "0",
                html: ""
            }
        }
        ,
        n.prototype.latex = function() {
            return "\\left" + this.sides[t].ctrlSeq + this.getEnd(t).latex() + "\\right" + this.sides[1].ctrlSeq
        }
        ,
        n.prototype.mathspeak = function(n) {
            var r = this.sides[t].ch
              , i = this.sides[1].ch;
            if ("|" === r && "|" === i)
                this.mathspeakTemplate = ["StartAbsoluteValue,", ", EndAbsoluteValue"],
                this.ariaLabel = "absolute value";
            else {
                if (n && n.createdLeftOf && this.side) {
                    var o = "";
                    return this.side === t ? o = this.textTemplate[0] : 1 === this.side && (o = this.textTemplate[1]),
                    (this.side === t ? "left " : "right ") + Ht[o]
                }
                this.mathspeakTemplate = ["left " + Ht[r] + ",", ", right " + Ht[i]],
                this.ariaLabel = Ht[r] + " block"
            }
            return e.prototype.mathspeak.call(this)
        }
        ,
        n.prototype.matchBrack = function(e, r, i) {
            return i instanceof n && i.side && i.side !== -r && (!e.restrictMismatchedBrackets || Gt[this.sides[this.side].ch] === i.sides[i.side].ch || {
                "(": "]",
                "[": ")"
            }[this.sides[t].ch] === i.sides[1].ch) && i
        }
        ,
        n.prototype.closeOpposing = function(e) {
            e.side = 0,
            e.sides[this.side] = this.sides[this.side];
            var n = e.delimjQs.eq(this.side === t ? 0 : 1).removeClass("dcg-mq-ghost");
            this.replaceBracket(n, this.side)
        }
        ,
        n.prototype.createLeftOf = function(n) {
            var r;
            if (!this.replacedFragment) {
                var i = n.options;
                r = "|" === this.sides[t].ch ? this.matchBrack(i, 1, n[1]) || this.matchBrack(i, t, n[t]) || this.matchBrack(i, 0, n.parent.parent) : this.matchBrack(i, -this.side, n[-this.side]) || this.matchBrack(i, -this.side, n.parent.parent)
            }
            if (r) {
                var o = this.side = -r.side;
                this.closeOpposing(r),
                r === n.parent.parent && n[o] && new m(n[o],n.parent.getEnd(o),-o).disown().withDirAdopt(-o, r.parent, r, r[o]).jQ.insDirOf(o, r.jQ),
                r.bubble(function(t) {
                    t.reflow()
                })
            } else
                o = (r = this).side,
                r.replacedFragment ? r.side = 0 : n[-o] && (r.replaces(new m(n[-o],n.parent.getEnd(-o),o)),
                n[-o] = 0),
                e.prototype.createLeftOf.call(this, n);
            o === t ? n.insAtLeftEnd(r.getEnd(t)) : n.insRightOf(r)
        }
        ,
        n.prototype.placeCursor = function() {}
        ,
        n.prototype.unwrap = function() {
            this.getEnd(t).children().disown().adopt(this.parent, this, this[1]).jQ.insertAfter(this.jQ),
            this.remove()
        }
        ,
        n.prototype.deleteSide = function(e, n, r) {
            var i = this.parent
              , o = this[e]
              , s = i.getEnd(e);
            if (e === this.side)
                return this.unwrap(),
                void (o ? r.insDirOf(-e, o) : r.insAtDirEnd(e, i));
            var a = r.options
              , c = !this.side;
            if (this.side = -e,
            this.matchBrack(a, e, this.getEnd(t).getEnd(this.side))) {
                this.closeOpposing(this.getEnd(t).getEnd(this.side));
                var l = this.getEnd(t).getEnd(e);
                this.unwrap(),
                l && l.siblingCreated(r.options, e),
                o ? r.insDirOf(-e, o) : r.insAtDirEnd(e, i)
            } else {
                if (this.matchBrack(a, e, this.parent.parent))
                    this.parent.parent.closeOpposing(this),
                    this.parent.parent.unwrap();
                else {
                    if (n && c)
                        return this.unwrap(),
                        void (o ? r.insDirOf(-e, o) : r.insAtDirEnd(e, i));
                    this.sides[e] = function(t) {
                        var e = t.side
                          , n = t.sides[e];
                        return {
                            ch: Gt[n.ch],
                            ctrlSeq: Gt[n.ctrlSeq]
                        }
                    }(this);
                    var p = this.delimjQs.removeClass("dcg-mq-ghost").eq(e === t ? 0 : 1).addClass("dcg-mq-ghost");
                    this.replaceBracket(p, e)
                }
                if (o) {
                    l = this.getEnd(t).getEnd(e);
                    new m(o,s,-e).disown().withDirAdopt(-e, this.getEnd(t), l, 0).jQ.insAtDirEnd(e, this.getEnd(t).jQ.removeClass("dcg-mq-empty")),
                    l && l.siblingCreated(r.options, e),
                    r.insDirOf(-e, o)
                } else
                    n ? r.insDirOf(e, this) : r.insAtDirEnd(e, this.getEnd(t))
            }
        }
        ,
        n.prototype.replaceBracket = function(e, n) {
            var r = this.getSymbol(n);
            e.html(r.html).css("width", r.width),
            n === t ? e.next().css("margin-left", r.width) : e.prev().css("margin-right", r.width)
        }
        ,
        n.prototype.deleteTowards = function(t, e) {
            this.deleteSide(-t, !1, e)
        }
        ,
        n.prototype.finalizeTree = function() {
            this.getEnd(t).deleteOutOf = function(t, e) {
                this.parent.deleteSide(t, !0, e)
            }
            ,
            this.finalizeTree = this.intentionalBlur = function() {
                this.delimjQs.eq(this.side === t ? 1 : 0).removeClass("dcg-mq-ghost"),
                this.side = 0
            }
        }
        ,
        n.prototype.siblingCreated = function(t, e) {
            e === -this.side && this.finalizeTree()
        }
        ,
        n
    }(Pt);
    var Gt = {
        "(": ")",
        ")": "(",
        "[": "]",
        "]": "[",
        "{": "}",
        "}": "{",
        "\\{": "\\}",
        "\\}": "\\{",
        "&lang;": "&rang;",
        "&rang;": "&lang;",
        "\\langle ": "\\rangle ",
        "\\rangle ": "\\langle ",
        "|": "|",
        "\\lVert ": "\\rVert ",
        "\\rVert ": "\\lVert "
    }
      , Ht = {
        "&lang;": "angle-bracket",
        "&rang;": "angle-bracket",
        "|": "pipe"
    };
    function Ut(e, n, r) {
        n = n || e;
        var i = Gt[e]
          , o = Gt[n];
        v[e] = function() {
            return new $t(t,e,i,n,o)
        }
        ,
        v[i] = function() {
            return new $t(1,e,i,n,o)
        }
        ,
        Ht[e] = Ht[i] = r
    }
    Ut("(", "", "parenthesis"),
    Ut("[", "", "bracket"),
    Ut("{", "\\{", "brace"),
    g.langle = function() {
        return new $t(t,"&lang;","&rang;","\\langle ","\\rangle ")
    }
    ,
    g.rangle = function() {
        return new $t(1,"&lang;","&rang;","\\langle ","\\rangle ")
    }
    ,
    v["|"] = function() {
        return new $t(t,"|","|","|","|")
    }
    ,
    g.lVert = function() {
        return new $t(t,"&#8741;","&#8741;","\\lVert ","\\rVert ")
    }
    ,
    g.rVert = function() {
        return new $t(1,"&#8741;","&#8741;","\\lVert ","\\rVert ")
    }
    ,
    g.left = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.parser = function() {
            var t = B.regex
              , e = B.string
              , n = B.optWhitespace;
            return n.then(t(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(r) {
                var i = r.replace(/^\\/, "");
                return "\\langle" == r && (i = "&lang;",
                r += " "),
                "\\lVert" == r && (i = "&#8741;",
                r += " "),
                $.then(function(o) {
                    return e("\\right").skip(n).then(t(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(t) {
                        var e = t.replace(/^\\/, "");
                        "\\rangle" == t && (e = "&rang;",
                        t += " "),
                        "\\rVert" == t && (e = "&#8741;",
                        t += " ");
                        var n = new $t(0,i,e,r,t);
                        return n.blocks = [o],
                        o.adopt(n, 0, 0),
                        n
                    })
                })
            })
        }
        ,
        e
    }(Y),
    g.right = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.parser = function() {
            return B.fail("unmatched \\right")
        }
        ,
        e
    }(Y);
    var Wt = Ot["("]
      , Vt = Ot[")"]
      , Kt = function(t) {
        function e() {
            var e = null !== t && t.apply(this, arguments) || this;
            return e.ctrlSeq = "\\binom",
            e.htmlTemplate = '<span class="dcg-mq-non-leaf dcg-mq-bracket-container"><span style="width:' + Wt.width + '" class="dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled">' + Wt.html + '</span><span style="margin-left:' + Wt.width + "; margin-right:" + Vt.width + ';" class="dcg-mq-non-leaf dcg-mq-bracket-middle"><span class="dcg-mq-array dcg-mq-non-leaf"><span>&0</span><span>&1</span></span></span><span style="width:' + Vt.width + '" class="dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled">' + Vt.html + "</span></span>",
            e.textTemplate = ["choose(", ",", ")"],
            e.mathspeakTemplate = ["StartBinomial,", "Choose", ", EndBinomial"],
            e.ariaLabel = "binomial",
            e
        }
        return __extends(e, t),
        e
    }(Pt);
    g.binom = g.binomial = Kt,
    g.choose = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.createLeftOf = function(t) {
            Bt.prototype.createLeftOf(t)
        }
        ,
        e
    }(Kt);
    var Yt = function(e) {
        function n() {
            var t = null !== e && e.apply(this, arguments) || this;
            return t.ctrlSeq = "\\MathQuillMathField",
            t.htmlTemplate = '<span class="dcg-mq-editable-field"><span class="dcg-mq-root-block">&0</span></span>',
            t
        }
        return __extends(n, e),
        n.prototype.parser = function() {
            var t = this
              , n = B.string
              , r = B.regex
              , i = B.succeed;
            return n("[").then(r(/^[a-z][a-z0-9]*/i)).skip(n("]")).map(function(e) {
                t.name = e
            }).or(i(void 0)).then(e.prototype.parser.call(this))
        }
        ,
        n.prototype.finalizeTree = function(e) {
            var n = new V(this.getEnd(t),this.jQ,e);
            n.KIND_OF_MQ = "MathField",
            n.editable = !0,
            n.createTextarea(),
            n.editablesTextareaEvents(),
            n.cursor.insAtRightEnd(n.root),
            Q(n.root)
        }
        ,
        n.prototype.registerInnerField = function(e, n) {
            var r = new n(this.getEnd(t).controller);
            e[this.name] = r,
            e.push(r)
        }
        ,
        n.prototype.latex = function() {
            return this.getEnd(t).latex()
        }
        ,
        n.prototype.text = function() {
            return this.getEnd(t).text()
        }
        ,
        n
    }(Y);
    g.editable = g.MathQuillMathField = Yt;
    var Zt = function(t) {
        function e() {
            return null !== t && t.apply(this, arguments) || this
        }
        return __extends(e, t),
        e.prototype.setOptions = function(t) {
            function e() {
                return ""
            }
            return this.text = t.text || e,
            this.htmlTemplate = t.htmlString || "",
            this.latex = t.latex || e,
            this
        }
        ,
        e.prototype.parser = function() {
            var t = this
              , e = B.string
              , n = B.regex
              , r = B.succeed;
            return e("{").then(n(/^[a-z][a-z0-9]*/i)).skip(e("}")).then(function(i) {
                return e("[").then(n(/^[-\w\s]*/)).skip(e("]")).or(r(void 0)).map(function(e) {
                    return t.setOptions(_[i](e))
                })
            })
        }
        ,
        e
    }(Z);
    g.embed = Zt;
    var Xt = A(1);
    for (var Jt in Xt)
        !function(t, e) {
            "function" == typeof e ? (T[t] = function() {
                return L(),
                e.apply(this, arguments)
            }
            ,
            T[t].prototype = e.prototype) : T[t] = e
        }(Jt, Xt[Jt])
}();